# ***************************************************************************
# Broadcom Proprietary and Confidential. (c)2017 Broadcom. All rights reserved.
#
# THIS SOFTWARE MAY ONLY BE USED SUBJECT TO AN EXECUTED SOFTWARE LICENSE
# AGREEMENT  BETWEEN THE USER AND BROADCOM.  YOU HAVE NO RIGHT TO USE OR
# EXPLOIT THIS MATERIAL EXCEPT SUBJECT TO THE TERMS OF SUCH AN AGREEMENT.
#
# ***************************************************************************

[version 1.37]

include config/flashmaps.cfg
include config/stdbuild.cfg

config ZEUS5_1 on

config ENET		on
config SYSTEMPORT	on
config GENET		off

config USB_BDC on
config USB_EHCI_OHCI	off

[family 7278b0]

include config/A53v7.cfg
include config/bsp_config.cfg
include config/layout-zeus51.cfg

gset BCHP_CHIP 7278
gset BCHP_REV  b0
gset MEMC_REV B310_G00

i2cbus BSCE # board ID via BSC_M4

cmdlevel 3

dts config/family-7278b0.dts
include config/A53-peripherals.cfg

# mapping between MEMC & CPU in the ascending order of MEMC and offset in MEMC
mmap 0 0x00000000 0x0040000000  0x80000000 # [0gb..2gb)@MEMC0 -> [ 1gb.. 3gb)
mmap 0 0x80000000 0x0100000000 0x180000000 # [2gb..8gb)@MEMC0 -> [ 4gb..10gb)
mmap 1 0x00000000 0x00C0000000  0x40000000 # [0gb..1gb)@MEMC1 -> [ 3gb.. 4gb)
mmap 1 0x40000000 0x0300000000 0x1C0000000 # [1gb..8gb)@MEMC1 -> [12gb..19gb)

include config/mmap-v7-64.cfg

rtsconfig -id 0 -file config/family-7278a0-box0.rts
rtsdefault -id 1

rtsbase 0 MEMC_ARB_0_CLIENT_INFO_0
rtsbase 1 MEMC_ARB_1_CLIENT_INFO_0

# PINMUX for console UART
pmux -pin gpio_069,gpio_070 -sel uart_ -n 2
# board ID at BSC_M4
pmux -pin sgpio_02,sgpio_03 -sel bsc_m4_ -n 2

avs enable -domains 2 -mode dvfs -pmap 2 -pstate 0
dt autogen -node avs_cpu

# nand boot shapes
nandshape 0b11000 0b00000
nandshape 0b11000 0b01000
nandshape 0b11000 0b10000

# list of possible nand chips (for all boards)
include config/nandchips.cfg

# flash map selection
mapselect STB_BP3

# Auto generate device nodes in the device tree
include config/A53-stddevices.cfg
dt autogen -node serial -compatible brcm,bcm7278-uart brcm,bcm7271-uart ns16550a -stdout A
dt autogen -node gisb_arb -compatible brcm,bcm7278-gisb-arb

# First instance is for the CPU/host
dt autogen -node systemport -choose 0,1
dt autogen -node sf2_switch

sdio -controller 0 -type nodevice
sdio -controller 1 -type nodevice

[chip 7278b0]
ddr -n 0 -size_mb 2048 -base_mb 1024 -clk 1867MHz -size_bits 8G -width 16 -phy 32
ddr -n 1 -size_mb 2048 -base_mb 3072 -clk 1867MHz -size_bits 8G -width 16 -phy 32
# Built-in ASP port
enet -switch_port 5 -phy_type GMII -mdio_mode 0 -phy_speed 1000 -phy_id 257
enet -switch_port 7 -phy_type GMII -mdio_mode 0 -phy_speed 1000 -phy_id 257

[board BCM97278SV : chip.7278b0]
comment Silicon Validation
bid 0x10 # BCM97278SV_V00_REV05.pdf

sdio -controller 0 -type sd -uhs 1
sdio -controller 1 -type emmc
# voltage regulators that turn on gpio's for PCIe devices
vreg -name wlan -gpio upg_gio_aon -pin 0 -active hi
vreg -name wifi -gpio upg_gio_aon -pin 12 -active hi
# (likely) Wi-Fi devices on PCIe#0/1, give them unique MAC addresses
pcie -controller 0 -type nominal -bus 1 -slot 0 -mac 1 -pwr wifi
pcie -controller 1 -type nominal -bus 3 -slot 0 -mac 1 -pwr wlan

pmux -pin gpio_000,gpio_001 -sel enet0_gphy_ -n 2 # LED's for Ethernet
pmux -pin gpio_002:gpio_013 -sel enet1_rgmii_ -n 12 # RGMII#0
pmux -pin gpio_014,gpio_015 -sel enet_md -n 2 # MDIO bus to external PHYs
pmux -pin gpio_016 -sel enet1_rgmii
# gpio_017~018 NC
pmux -pin gpio_019:gpio_028 -sel mtsif0_ -n 10
pmux -pin gpio_029,gpio_030 -sel mtsif_ats_ -n 2
# gpio_031~039 incomplete functions, gpio
pmux -pin gpio_040:gpio_043 -sel uart_ -n 4
# gpio_044~047 incomplete function
pmux -pin gpio_048:gpio_052 -sel sc0_ -n 5
# gpio_053~054 skip SC AUX1/AUX2, NDS driver to configure if needed
pmux -pin gpio_055 -sel sc0_vpp
# gpio_056~058 incomplete function
pmux -pin gpio_059:gpio_063 -sel sc1_ -n 5
# gpio_064~065 skip SC AUX1/AUX2, NDS driver to configure if needed
pmux -pin gpio_066 -sel sc1_vpp
# gpio_067~068 gpio
# gpio_069~070 family common console UART
pmux -pin gpio_071:gpio_075 -sel pkt_ -n 5
pmux -pin gpio_076,gpio_077 -sel sd_card0_ -pull up -n 2
pmux -pin gpio_078,gpio_079 -sel sd_card0_ -n 2
pmux -pin gpio_080:gpio_084 -sel sd_card0_ -pull up -n 5
pmux -pin gpio_085,gpio_086 -sel sd_card0_ -n 2
pmux -pin gpio_087:gpio_096 -sel mtsif1_ -n 10
# gpio_097~107 eMMC over SDIO#1
# gpio_108 gpio
pmux -pin sgpio_00:sgpio_01 -sel bsc_m3_ -n 2
# sgpio_02~03 family common BSC for BID

# aon_gpio_00 gpio
pmux -pin aon_gpio_01:aon_gpio_03 -sel i2s0_in_ -n 3
pmux -pin aon_gpio_04 -sel led_ls_0
pmux -pin aon_gpio_05:aon_gpio_07 -sel spi_m_ -n 3
pmux -pin aon_gpio_08 -sel led_ls_4
# aon_gpio_09 gpio
pmux -pin aon_gpio_10,aon_gpio_11 -sel led_ld_ -n 2
# aon_gpio_12 gpio
pmux -pin aon_gpio_13:aon_gpio_16 -sel spi_m_ -n 4
pmux -pin aon_sgpio_00:aon_sgpio_03 -sel hdmi_ -n 4
pmux -pin aon_sgpio_04,aon_sgpio_05 -sel bsc_m2_ -n 2

# SYSTEMPORT lite + SWITCH
enet -switch_port 0 -phy_type INT -mdio_mode 1 -phy_speed 1000 -phy_id 5 # built-in
# Broadcom 54610 external PHY
enet -switch_port 1 -phy_type RGMII_NO_ID -mdio_mode 1 -phy_speed 1000 -phy_id 1
# Broadcom 54810 external PHY
enet -switch_port 2 -phy_type RGMII -mdio_mode 1 -phy_speed 1000 -phy_id 7

[board BCM97278HB: chip.7278b0]
comment Hybrid
bid 0x22 # BCM97278HB_V10_REV02

sdio -controller 0 -type sd -uhs 1
sdio -controller 1 -type emmc
# voltage regulators that turn on gpio's for PCIe device
vreg -name wifi -gpio upg_gio_aon -pin 1 -active lo
vreg -name rf -gpio upg_gio_aon -pin 2 -active hi
# (likely) Wi-Fi device on PCIe#0, give it a unique MAC address
pcie -controller 0 -type nominal -bus 1 -slot 0 -mac 1 -pwr wifi,rf
usb -controller 0 -type nominal -bdc dual # enable DRD mode

pmux -pin gpio_000,gpio_001 -sel enet0_gphy_ -n 2 # LED's for Ethernet
# gpio_002~005 NC
pmux -pin gpio_006,gpio_007 -sel uart_ -n 2 # UART#1
# gpio_008~009 NC
pmux -pin gpio_010,gpio_011 -sel uart_ -n 2 # UART#2
# gpio_012~018 NC,gpio
pmux -pin gpio_019:gpio_028 -sel mtsif0_ -n 10
pmux -pin gpio_029,gpio_030 -sel mtsif_ats_ -n 2
# gpio_031~058 NC,gpio
pmux -pin gpio_059:gpio_063 -sel sc1_ -n 5
# gpio_064~065 skip SC AUX1/AUX2, NDS driver to configure if needed
pmux -pin gpio_066 -sel sc1_vpp
# gpio_067~068 gpio,NC
# gpio_069~070 family common console UART
# gpio_071~075 NC
pmux -pin gpio_076 -sel sd_card0_cmd -pull up
pmux -pin gpio_077 -sel sd_card0_wprot -pull down # uSD, NO pin for WP
pmux -pin gpio_078,gpio_079 -sel sd_card0_ -n 2
pmux -pin gpio_080:gpio_084 -sel sd_card0_ -pull up -n 5
pmux -pin gpio_085,gpio_086 -sel sd_card0_ -n 2
# gpio_087~108 NC,gpio
# sgpio_00~01 NC
# sgpio_02~03 family common BSC for BID

# aon_gpio_00~04 gpio
pmux -pin aon_gpio_05 -sel spi_m_ss1b
# aon_gpio_06~12 strap,gpio
pmux -pin aon_gpio_13:aon_gpio_16 -sel spi_m_ -n 4
pmux -pin aon_sgpio_00:aon_sgpio_03 -sel hdmi_ -n 4
pmux -pin aon_sgpio_04,aon_sgpio_05 -sel bsc_m2_ -n 2

[board BCM97278HB_MAX3200 : chip.7278b0]
comment Hybrid with LPDDR4-3200 maximum
bid 0x23 # BCM97278HB_V00_REV10.pdf

# 1600 MHz (LPDDR4-3200)
ddr -n 0 -size_mb 2048 -base_mb 1024 -clk 1600MHz -size_bits 8G -width 16 -phy 32
ddr -n 1 -size_mb 2048 -base_mb 3072 -clk 1600MHz -size_bits 8G -width 16 -phy 32

sdio -controller 0 -type sd -uhs 1
sdio -controller 1 -type emmc
# voltage regulators that turn on gpio's for PCIe device
vreg -name wifi -gpio upg_gio_aon -pin 1 -active lo
vreg -name rf -gpio upg_gio_aon -pin 2 -active hi
# (likely) Wi-Fi device on PCIe#0, give it a unique MAC address
pcie -controller 0 -type nominal -bus 1 -slot 0 -mac 1 -pwr wifi,rf
usb -controller 0 -type nominal -bdc dual # enable DRD mode

pmux -pin gpio_000,gpio_001 -sel enet0_gphy_ -n 2 # LED's for Ethernet
# gpio_002~005 NC
pmux -pin gpio_006,gpio_007 -sel uart_ -n 2 # UART#1
# gpio_008~009 NC
pmux -pin gpio_010,gpio_011 -sel uart_ -n 2 # UART#2
# gpio_012~018 NC,gpio
pmux -pin gpio_019:gpio_028 -sel mtsif0_ -n 10
pmux -pin gpio_029,gpio_030 -sel mtsif_ats_ -n 2
# gpio_031~068 NC,gpio
# gpio_069~070 family common console UART
# gpio_071~075 NC
pmux -pin gpio_076 -sel sd_card0_cmd -pull up
pmux -pin gpio_077 -sel sd_card0_wprot -pull down # uSD, NO pin for WP
pmux -pin gpio_078,gpio_079 -sel sd_card0_ -n 2
pmux -pin gpio_080:gpio_084 -sel sd_card0_ -pull up -n 5
pmux -pin gpio_085,gpio_086 -sel sd_card0_ -n 2
# gpio_087~108 NC,gpio
# sgpio_00~01 NC
# sgpio_02~03 family common BSC for BID

# aon_gpio_00~04 gpio
pmux -pin aon_gpio_05 -sel spi_m_ss1b
# aon_gpio_06~12 strap,gpio
pmux -pin aon_gpio_13:aon_gpio_16 -sel spi_m_ -n 4
pmux -pin aon_sgpio_00:aon_sgpio_03 -sel hdmi_ -n 4
pmux -pin aon_sgpio_04,aon_sgpio_05 -sel bsc_m2_ -n 2

[board BCM97278HB_REV09MAX3200 : board.BCM97278HB_MAX3200]
comment Hybrid without UHS on uSD
bid 0x20 # upto REV09 of BCM97278HB_V00

sdio -controller 0 -type sd -uhs 0
pmux -pin gpio_086 -sel gpio_086 # NO SD_CARD0_VOLT

[board BCM97278IPA : chip.7278b0]
comment IP Android
bid 0x21 # BCM97278IPA_V00_REV02.pdf

ddr -n 0 -size_mb 1024 -base_mb 1024 -clk 1867MHz -size_bits 8G -width 32 -phy 32
ddr -n 1 -size_mb 1024 -base_mb 3072 -clk 1867MHz -size_bits 8G -width 32 -phy 32

enet -switch_port 0 -phy_type INT -mdio_mode 1 -phy_speed 1000 -phy_id 5 # built-in
sdio -controller 0 -type sd -uhs 1
sdio -controller 1 -type emmc
# voltage regulator that turns on PCIe device
vreg -name wifi -gpio upg_gio -pin 24 -active hi
# (likely) Wi-Fi device on PCIe#0, give it a unique MAC address
pcie -controller 0 -type nominal -bus 1 -slot 0 -mac 1 -pwr wifi
usb -controller 0 -type nominal -bdc dual # enable DRD mode

pmux -pin gpio_000,gpio_001 -sel enet0_gphy_ -n 2 # LED's for Ethernet
# gpio_002~005 NC
pmux -pin gpio_006,gpio_007 -sel uart_ -n 2 # UART#1
# gpio_008~009 NC
pmux -pin gpio_010,gpio_011 -sel uart_ -n 2 # UART#2
# gpio_012~068 NC,gpio
# gpio_069~070 family common console UART
# gpio_071~075 NC
pmux -pin gpio_076 -sel sd_card0_cmd -pull up
pmux -pin gpio_077 -sel sd_card0_wprot -pull down # uSD, NO pin for WP
pmux -pin gpio_078,gpio_079 -sel sd_card0_ -n 2
pmux -pin gpio_080:gpio_084 -sel sd_card0_ -pull up -n 5
pmux -pin gpio_085,gpio_086 -sel sd_card0_ -n 2
# gpio_087~108 NC
# sgpio_00~01 NC
# sgpio_02~03 family common BSC for BID

# aon_gpio_00~16 gpio,strap,NC
pmux -pin aon_sgpio_00:aon_sgpio_03 -sel hdmi_ -n 4
# aon_sgpio_04~05 pulled up

[board BCM97278VMS : chip.7278b0]
comment Video Media Server
bid 0x30 # BCM97278VMS_V00_REV02

avs enable -domains 1 -mode dfs -pmap 1 -pstate 0
# BCM3390 on RGMII#0, MAC-to-MAC
enet -switch_port 1 -phy_type RGMII -mdio_mode 0 -phy_speed 1000 -phy_id 257
sdio -controller 0 -type sd -uhs 1
sdio -controller 1 -type emmc

# gpio_000~001 NC, strap
pmux -pin gpio_002:gpio_013 -sel enet1_rgmii_ -n 12 # RGMII#0
# gpio_014~018 gpio,NC
pmux -pin gpio_019:gpio_028 -sel mtsif0_ -n 10
pmux -pin gpio_029,gpio_030 -sel mtsif_ats_ -n 2
# gpio_031~039 NC
pmux -pin gpio_040,gpio_041 -sel uart_ -n 2 # UART#1
# gpio_042~043 DNI'ed
# gpio_044~047 NC
pmux -pin gpio_048:gpio_052 -sel sc0_ -n 5
# gpio_053~054 skip SC AUX1/AUX2, NDS driver to configure if needed
pmux -pin gpio_055 -sel sc0_vpp
# gpio_051~068 NC
# gpio_069~070 family common console UART
# gpio_071 NC
pmux -pin gpio_072 -sel pwm_0
# gpio_073~075 gpio,NC
pmux -pin gpio_076 -sel sd_card0_cmd -pull up
pmux -pin gpio_077 -sel sd_card0_wprot -pull down # uSD, NO pin for WP
pmux -pin gpio_078,gpio_079 -sel sd_card0_ -n 2
pmux -pin gpio_080:gpio_084 -sel sd_card0_ -pull up -n 5
pmux -pin gpio_085,gpio_086 -sel sd_card0_ -n 2
# gpio_087~108 NC,gpio
# sgpio_00~01 NC
# sgpio_02~03 family common BSC for BID

# aon_gpio_00~16 NC,gpio,strap
pmux -pin aon_sgpio_00:aon_sgpio_03 -sel hdmi_ -n 4
# aon_sgpio_04~05 NC

[end]

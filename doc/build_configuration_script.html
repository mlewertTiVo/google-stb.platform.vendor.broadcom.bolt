<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Build configuration script</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(3);
/*]]>*/
</script>
</head>
<body class="book" style="max-width:100%">
<div id="header">
<h1>Build configuration script</h1>
<span id="author">Broadcom Ltd</span><br />
<span id="email"><code>&lt;<a href="mailto:support@broadcom.com">support@broadcom.com</a>&gt;</code></span><br />
<span id="revnumber">version 1.37,</span>
<span id="revdate">June 9th 2017</span>
<br /><span id="revremark">Updated for 1.30 release.</span>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph"><p>The BOLT makesystem now auto-generates a range of files for building BOLT
depending upon a configuration script. The purpose of such scripting is
to put in one place all the information required for a build in an easier
to comprehend format. Once a script has been run, BOLT is ready to be built.</p></div>
<div class="paragraph"><p>The configuration and build is a one-step process for the user.</p></div>
<div class="paragraph"><p>The default script is in the file config/family-&lt;FAMILY&gt;.cfg where &lt;FAMILY&gt;
is the chip family specified by the user, e.g. <em>make 7445a0</em> will use
the file config/family-7445a0.cfg</p></div>
<div class="paragraph"><p>Code and makefiles are built from the configuration and
placed in the <em>gen/&lt;FAMILY&gt;</em> directory. Build objects will be in the
<em>objs/&lt;FAMILY&gt;</em> directory. Linker scripts are generated as a
separate part of the build (by makefiles) but note that the values in
them are specified by the script - via search &amp; replace operations
from generated makefile variables.</p></div>
<div class="paragraph"><p>Linker scripts in <em>objs/&lt;FAMILY&gt;</em> and items in <em>gen/&lt;FAMILY&gt;</em>
should never be modified by hand.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_building">2. Building</h2>
<div class="sectionbody">
<div class="paragraph"><p>To show which chip families are available: <em>make show</em></p></div>
<div class="paragraph"><p>To make a specific family: <em>make &lt;FAMILY&gt;</em> Where &lt;FAMILY&gt; is
one of the items listed by <em>make show</em></p></div>
<div class="paragraph"><p>To erase the current build configuration: <em>make clean</em></p></div>
<div class="paragraph"><p>To build using another configuration file for a family, the family and file
have to be specified using FAMILY and CFG to the makesystem, e.g.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> make FAMILY=7445d0 CFG=config/testing/ddrtests-7445.cfg</code></pre>
</div></div>
<div class="paragraph"><p>Once specified, the FAMILY and/or CFG no longer have to be
used between building BOLT. Only when a different configuration and/or
family is required do you need to re-specify them, i.e. <em>make clean all</em>
may be done with abandon without destroying the current configuration.</p></div>
<div class="paragraph"><p>RTS settings (.rts) and Device Tree source (.dts) files are specified
withing a configuration file.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_scripting">3. Scripting</h2>
<div class="sectionbody">
<div class="paragraph"><p>A script consists of headings with a range of commands under them. The file
extension is <em>cfg</em></p></div>
<div class="paragraph"><p>A heading is bounded by square brackets and may contain a value. If a value is
specified for a heading, it must be included.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> [&lt;heading&gt; &lt;VALUE&gt;]
   &lt;command&gt;
   &lt;command&gt;
    ...</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code> [&lt;heading&gt;]
   &lt;command&gt;
   &lt;command&gt;
    ...</code></pre>
</div></div>
<div class="paragraph"><p>Commands may specify either a hard wired option for a build or a
runtime selection for a specific board. The command reference
section (below) will specify one or the other.</p></div>
<div class="paragraph"><p>If a command parameter starts with a minus sign <em>-</em> then
those parameters may appear in any order on that line. If not,
then the ordering of values is important and must be followed.</p></div>
<div class="paragraph"><p>Command continuation <em>\</em> is allowed, but use with care.</p></div>
<div class="paragraph"><p><em>family</em>, <em>chip</em> and <em>board</em> headings that relate to runtime
board selection commands have inheritance in that anything referencing
a previous heading inherits its commands properties. These properties
may be overridden in the current heading.</p></div>
<div class="paragraph"><p>Comments may consist of c style <em>/* */</em> and Perl <em>#</em>
delimiters but may not span over one line.</p></div>
<div class="paragraph"><p>If an invalid command is encountered then the script
stops with an error.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_headings">4. Headings</h2>
<div class="sectionbody">
<div class="paragraph"><p>Valid headings:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> [version VALUE]

 [config]

 [map VALUE]

 [family VALUE]

 [chip VALUE]

 [board VALUE]

 [end]</code></pre>
</div></div>
<div class="paragraph"><p>The ordering of the headings is important, and the above list shows the
order expected. The script checks this.</p></div>
<div class="sect2">
<h3 id="_version">4.1.  [version]</h3>
<div class="paragraph"><p>Usage: [version VALUE]</p></div>
<div class="paragraph"><p>Note: The version of the config file.</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> [version 1.1]</code></pre>
</div></div>
<div class="paragraph"><p>The script will check VALUE against its own version information and will
abort processing if they do not match. The purpose is to prevent mismatches
between new BOLT deliverables and a customers previous custom BOLT build
script files.</p></div>
</div>
<div class="sect2">
<h3 id="_config">4.2.  [config]</h3>
<div class="paragraph"><p>Usage: [config]</p></div>
<div class="paragraph"><p>Note: Hard wired build configuration features</p></div>
<div class="paragraph"><p>See also: config (command)</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[config]</code></pre>
</div></div>
<div class="paragraph"><p>This contains the build feature commands for BOLT e.g. USB, networking etc.</p></div>
</div>
<div class="sect2">
<h3 id="_map">4.3.  [map]</h3>
<div class="paragraph"><p>Usage: [map VALUE]</p></div>
<div class="paragraph"><p>Note: define a FLASH partition profile entry</p></div>
<div class="paragraph"><p>See also: map (command)</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[map STB_RG_fixed]</code></pre>
</div></div>
<div class="paragraph"><p>We can specify how all the flash devices will be split into partitions (MTD
devices in Linux). These partitions will be passed via Device Tree for use in
Linux. Note that a single map heading should include the partition map for all
the flash devices in the system.</p></div>
</div>
<div class="sect2">
<h3 id="_family">4.4.  [family]</h3>
<div class="paragraph"><p>Usage:  [family VALUE]</p></div>
<div class="paragraph"><p>Note: Chip family configuration</p></div>
<div class="paragraph"><p>See also: avs cset mset gset cmdlevel dts rtsconfig rtsdefault
rtsbase pmux section nandshape nandchip enet moca
comment (commands)</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[family 7445a0]</code></pre>
</div></div>
<div class="paragraph"><p>This contains the hard wired build features and default
runtime configuration for each chip family. There must be
no more than one family heading per configuration.</p></div>
<div class="paragraph"><p>The name must match the value used for the makesystem
FAMILY variable, e.g. make FAMILY=7445a0</p></div>
</div>
<div class="sect2">
<h3 id="_chip">4.5.  [chip]</h3>
<div class="paragraph"><p>Usage: [chip VALUE [: chip.DERIVED_CHIP] ]</p></div>
<div class="paragraph"><p>Note: Chip configuration</p></div>
<div class="paragraph"><p>See also: avs pmux enet moca ddr comment (commands)</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[chip 7445a0]
[chip 72525b0 : chip.72521b0]</code></pre>
</div></div>
<div class="paragraph"><p>This contains only the default runtime configuration for each chip.
There may be multiple chips with different names.</p></div>
<div class="paragraph"><p>A chip configuration derives from the family configuration, or other
previously defined chip configuration if <em>: chip.DERIVED_CHIP</em> exists.</p></div>
</div>
<div class="sect2">
<h3 id="_board">4.6.  [board]</h3>
<div class="paragraph"><p>Usage: [board VALUE : DERIVED_OBJ [BOGUS] ]</p></div>
<div class="paragraph"><p>Note: Board configuration</p></div>
<div class="paragraph"><p>See also: avs chip pmux enet moca ext_moca ddr comment (commands)</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[board BCM97445VMSVMB_SFFV00 : chip.7445a0]
[board BCM97445C : board.BCM97445VMSVMB_SFFV00 ]
[board common : chip.7445a0 : BOGUS ]</code></pre>
</div></div>
<div class="paragraph"><p>This contains only the default runtime configuration
for each board. There may be multiple boards with different names,
each one of them derives from DERIVED_OBJ, which describes either
a previously defined chip or a previously defined board.  The
DERIVED_OBJ is in the form <em>chip.name</em> or <em>board.name</em>, depending
whether it is derived from a chip or a board.</p></div>
<div class="paragraph"><p>When defining a phony or pseudo board, you must add <em>: BOGUS</em>
to the derivation object.  This tells the Bolt scripts that
this board is only used for reference and should not be offered
to the Bolt user as a bonafide board choice.</p></div>
<div class="paragraph"><p>All boards listed in a configuration are shown on the FSBL menu
unless there is only one board, in which case it is automatically
selected and no menu appears.</p></div>
</div>
<div class="sect2">
<h3 id="_end">4.7.  [end]</h3>
<div class="paragraph"><p>Usage: [end]</p></div>
<div class="paragraph"><p>Note: denotes the end of a configuration.</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[end]</code></pre>
</div></div>
<div class="paragraph"><p>This heading must be at the end of a configuration file.
No other text apart from comments must appear after it.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_commands">5. Commands</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_valid_commands">5.1. Valid commands</h3>
<div class="sect3">
<h4 id="_build_configuration">5.1.1. Build configuration</h4>
<div class="paragraph"><p>Commands that are enacted at build time.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    cmdlevel
    config
    cset
    dt autogen
    dts
    dtsinclude
    gset
    i2cbus
    ldfile
    map
    mmap
    mset
    nandchip
    nandshape
    rtsbase
    rtsconfig
    section</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_scripting_only">5.1.2. Scripting only</h4>
<div class="paragraph"><p>Build time commands that select certain environment features.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    chip
    include</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_board_configuration">5.1.3. Board configuration</h4>
<div class="paragraph"><p>Commands that enact a configuration at runtime.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    avs
    bid
    ddr
    dt
    enet
    mapselect
    memsys
    moca
    ext_moca
    pmux
    rtsdefault
    pcie
    sata
    sdio
    usb
    gpio_key
    gpio_led
    bt_rfkill_gpio</code></pre>
</div></div>
</div>
</div>
<div class="sect2">
<h3 id="_config_2">5.2.  config</h3>
<div class="paragraph"><p>Usage: config &lt;VALUE&gt;</p></div>
<div class="paragraph"><p>Note: set a BOLT feature build flag</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>config USB on</code></pre>
</div></div>
<div class="paragraph"><p>This sets one of a range of common build features for BOLT.
Each build feature is prefixed in the code by <em>CFG_</em>, for
example the above <em>config USB</em> would set CFG_USB in CFLAGS,
and the test would be:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>#if CFG_USB
/* feature*/
#endif</code></pre>
</div></div>
<div class="paragraph"><p>If a feature is not recognised by the script then
it will fail.</p></div>
<div class="paragraph"><p>A feature may hold either <em>on</em>, <em>off</em> (case insensitive), <em>default</em>
or a value. <em>on</em> &amp; <em>off</em> translate to a CFLAG value of <em>1</em> or <em>0</em>
respectively, while <em>default</em> does not set any value and removes
it from CFLAGS. If it holds any other value then it is passed
in CFLAGS. An example of this is <em>config SYSINIT</em> which is
used to pass a string, as well as indicating that it has been
defined.</p></div>
<div class="paragraph"><p>Config values are overridable (specify different values more than once)
up until the [family] heading is encountered, e.g.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> config USB on
 config USB off</code></pre>
</div></div>
<div class="paragraph"><p>USB is <em>off</em> (CFLAGS -DCFG_USB=0) if <em>config USB</em>
is not changed from this point onward, up until the
config has been fully processed.</p></div>
</div>
<div class="sect2">
<h3 id="_map_2">5.3.  map</h3>
<div class="paragraph"><p>Usage: map &lt;HEADING&gt; &lt;NAME&gt; &lt;SIZE&gt; &lt;DEVICE&gt;</p></div>
<div class="paragraph"><p>Note: Specify an entry in a flash partition profile</p></div>
<div class="paragraph"><p>See also: [map] (heading)</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>map example     bolt    1Mb     CS0</code></pre>
</div></div>
<div class="paragraph"><p>This command adds an entry to a flash partition profile map to
build up a set of partitions which should be registered for all flash devices.</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;HEADING&gt; should match  [map &lt;HEADING&gt;]
</p>
</li>
<li>
<p>
&lt;NAME&gt; is the name of the partition entry
</p>
</li>
<li>
<p>
&lt;SIZE&gt; is the size of the entry. <em>Kb</em>, <em>Mb</em> or <em>Gb</em> may be
appended and will be expanded to the right
amount. Any other symbol will be taken as a presumed legal c language
constant or pre-processor define.
</p>
</li>
<li>
<p>
&lt;DEVICE&gt; is the type of flash device on which this partition should
be placed. Can be any one of:
CS0 CS1 CS2 CS3 EMMC_BOOT EMMC_DATA
</p>
</li>
</ul></div>
<div class="paragraph"><p>The script snippet below will produce the following c code
for a flash partition:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>[map example]
map example     bolt    1Mb     CS0
map example     macadr  64Kb    CS0
map example     nvram   64Kb    CS0
map example     kernel  4Mb     CS0
map example     devtree 64Kb    CS0
map example     splash  512Kb   CS0
map example     rootfs  1024Mb  CS1</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>static struct partition_profile __maybe_unused partition_profile_example[] = {
        FIXED_PARTITION("bolt", 1*(1024*1024), CS0),
        FIXED_PARTITION("macadr", 64*(1024), CS0),
        FIXED_PARTITION("nvram", 64*(1024), CS0),
        FIXED_PARTITION("kernel", 4*(1024*1024), CS0),
        FIXED_PARTITION("devtree", 64*(1024), CS0),
        FIXED_PARTITION("splash", 512*(1024), CS0),
        FIXED_PARTITION("rootfs", 1024*(1024*1024), CS1),
        {}
};</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">All names must be compilable by gcc and that they must be
unique. Spaces are not allowed within a value.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_mapselect">5.4.  mapselect</h3>
<div class="paragraph"><p>Usage: mapselect &lt;VALUE&gt;</p></div>
<div class="paragraph"><p>Note: Select a partition map to use for this chip</p></div>
<div class="paragraph"><p>See also: map</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>mapselect STB</code></pre>
</div></div>
<div class="paragraph"><p>&lt;VALUE&gt; may be any one of the fixed partition mappings defined under a [map]
heading or it may be one of a pre-configured, flexible partitioning profiles. A
flexible profile allows BOLT to configure a given set of partitions to match
the flash available on the board. The partition placement and sizing will vary
depending on, for instance, whether the board has a single small SPI flash, a
SPI flash plus a larger NAND flash, or just a large NAND flash.</p></div>
<div class="paragraph"><p>You should select a default flash map to use in the [family] section and
that can be overridden in [chip] through to each [board]. This means
each board could have a different flash map, if so desired.</p></div>
<div class="paragraph"><p>Currently supported flexible map(s):</p></div>
<div class="ulist"><ul>
<li>
<p>
STB_OLD (do not use for new configurations)
</p>
</li>
<li>
<p>
STB
</p>
</li>
<li>
<p>
GATEWAY
</p>
</li>
<li>
<p>
STB_NO_MIRROR
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_memsys">5.5.  memsys</h3>
<div class="paragraph"><p>Usage: memsys [std|alt]</p></div>
<div class="paragraph"><p>Note: Select a preset area of flash to load SHMOO code from.</p></div>
<div class="paragraph"><p>See also: ddr</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>memsys std
memsys alt</code></pre>
</div></div>
<div class="paragraph"><p>The <em>memsys</em> command instructs the FSBL to load either the standard or an
alternate SHMOO (ddr bringup) code library from the MEMSYS or MEMSYS_ALT
section of BOLT. It allows either multiple versions or types e.g. DDR3
and DDR4, to be runtime selectable on a per board basis.</p></div>
<div class="paragraph"><p>The configuration script MEMC_REV variable specifies where to find (base
directory of) the standard SHMOO code library and MEMC_ALT where to find
the alternate.</p></div>
<div class="paragraph"><p>If MEMC_ALT is not defined in a configuration script then any board selected
in the FSBL that has the command <em>memsys alt</em> will error out at runtime.</p></div>
<div class="paragraph"><p>Defining MEMC_ALT is NOT SUPPORTED FOR SECURE BOOT BUILDS. Any occurrence
of it in a configuration script must be removed.</p></div>
<div class="paragraph"><p>If a <em>memsys</em> command is not specified then the standard MEMSYS
section of BOLT is used.</p></div>
<div class="paragraph"><p>It is up to the developer to correctly match MCBs (ddr configuration
data files) to standard or alternate SHMOO libraries. At the moment
MCB selection for a board does not select by which <em>memsys</em> it
belongs to.</p></div>
</div>
<div class="sect2">
<h3 id="mmap">5.6.  mmap</h3>
<div class="paragraph"><p>Usage: mmap &lt;MEMC&gt; &lt;OFFSET-FROM&gt; &lt;OFFSET-TO&gt; &lt;SIZE&gt;</p></div>
<div class="paragraph"><p>Note: Describes the memory map information between MEMC and
CPU address spaces.</p></div>
<div class="paragraph"><p>See also: ddr</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>mmap 1 0x00000000 0x0040000000 0x40000000 # [0gb..1gb)@MEMC1 -&gt; [ 1gb.. 2gb)
mmap 1 0x40000000 0x0300000000 0xC0000000 # [1gb..4gb)@MEMC1 -&gt; [12gb..15gb)</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">In the above example, [1GB..4GB) portion of DRAM installed on MEMC#1
is mapped to [12GB..15GB) of the CPU address space.</td>
</tr></table>
</div>
<div class="paragraph"><p>To support large amounts of memory (more than 4GB) while allowing
software to remain in the comfy 32-bit address space as much as possible,
DRAM installed on a memory controller requires mapping to CPU address
space. The mapping depends on the memory controller and the offset within
the DRAM address space, from 0 (zero) to the size of the installed DRAM.</p></div>
<div class="paragraph"><p>The installed DRAM of a board is mapped to the CPU address space via the
memory map information specified in the <em>map</em> command(s), and the mapped
result becomes the memory configuration of the board and is passed to
Linux.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">It is MANDATORY to provide memory map information for a chip
family.</td>
</tr></table>
</div>
<div class="paragraph"><p>The <em>mmap</em> commands should be only in the [family] section. All the chips
in a family share the same memory map information regardless of how many
memory controllers are actually accessible. Currently the <em>mmap</em> provided
values describe a <em>fixed</em> property of a chip i.e. they are not customer
modifiable and therefore must <span class="red">never</span> be altered.</p></div>
</div>
<div class="sect2">
<h3 id="_mset_gset_cset">5.7.  mset, gset, cset</h3>
<div class="paragraph"><p>Usage: mset|cset|gset &lt;VALUE&gt;</p></div>
<div class="paragraph"><p>Note: Set a makefile variable, CFLAG or both</p></div>
<div class="paragraph"><p>See also: config</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>gset MY_FLAG 99</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
mset sets a makefile variable
</p>
</li>
<li>
<p>
cset sets a CFLAG
</p>
</li>
<li>
<p>
gset sets both
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">&lt;VALUE&gt; is optional and may be omitted.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_section">5.8.  section</h3>
<div class="paragraph"><p>Usage: section -name &lt;NAME&gt; -off &lt;HEX-OFFSET&gt; -size &lt;HEX-SIZE&gt;</p></div>
<div class="paragraph"><p>Note: Define a memory layout within the BOLT binary.</p></div>
<div class="paragraph"><p>See also: memsys</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>section -name FSBL -off 0 -size 0x00001000</code></pre>
</div></div>
<div class="paragraph"><p>The section command defines a memory layout section.  If you specify a
section (eg -name XYZ) it will declare Make variables XYZ_TEXT_OFFS,
XYZ_TEXT_ADDR, and XYZ_SIZE.  The same names will also be added to
the CFLAGS define list.</p></div>
<div class="paragraph"><p>You can specify <em>-size auto</em> if the current and next sections'
offset values are defined.  Similarly, you may specify <em>-off auto</em>
if the previous section&#8217;s offset and size are defined.</p></div>
</div>
<div class="sect2">
<h3 id="_nandshape">5.9.  nandshape</h3>
<div class="paragraph"><p>Usage: nandshape &lt;MASK&gt; &lt;VALUE&gt;</p></div>
<div class="paragraph"><p>Note: nand boot shapes</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> nandshape 0b11000 0b00000</code></pre>
</div></div>
<div class="paragraph"><p>The bitmask and value to check if NAND was the
FLASH device used to boot the chip, tested against
pin strap inputs that the chip has.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">You should not normally need to change these values.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_nandchip">5.10.  nandchip</h3>
<div class="paragraph"><p>Usage: nandchip &lt;string&gt; -mask_lo &lt;value&gt; -mask_hi &lt;value&gt; -val_lo &lt;value&gt; -val_hi &lt;value&gt; -page_size &lt;value&gt; -block_size &lt;value&gt; -size &lt;value&gt; -oob &lt;value&gt; -ecc &lt;value&gt; -sector_size &lt;value&gt; -flags &lt;value&gt;</p></div>
<div class="paragraph"><p>Note: Specify parameters for a (non-ONFI) NAND chip.</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> nandchip -name "MT29F32G08CBACA" \
                -mask_lo 0xffffffff -mask_hi 0xff000000 \
                -val_lo 0x2c68044a -val_hi 0xa9000000 \
                -page_size 4096  \
                -block_size 1048576  \
                -size 4ULL*1024*1024*1024  \
                -oob 27 \
                -ecc 12 \
                -sector_size 512 \
                -flags 0</code></pre>
</div></div>
<div class="paragraph"><p>Manually set the configuration for NAND chips
to be identified in the first stage of the BOLT
bootloader (FSBL.) Handy if your platform does
not have ONFI standard NAND chips. You can add
multiple nandchip lines, though they take up
valuable space in the FSBL.</p></div>
<div class="paragraph"><p>You should obtain these values from the NAND
device manufacturers datasheet.</p></div>
<div class="sect3">
<h4 id="_flags">5.10.1. Flags</h4>
<div class="sect4">
<h5 id="_mask_lo_mask_hi_val_lo_val_hi"> -mask_lo, -mask_hi, -val_lo, -val_hi</h5>
<div class="paragraph"><p>Set the value of masks and chip ID when reading
the chip ID via the Broadcom NAND controller. You can use the
mask to request matching against parts of the ID (e.g.,
-mask_lo=0xffffff -mask_hi=0xff000000 will only match the first 5
bytes of the ID against -val_lo and -val_hi).</p></div>
</div>
<div class="sect4">
<h5 id="_page_size_block_size_size"> -page_size, -block_size, -size</h5>
<div class="paragraph"><p>Basic NAND device size, see the NAND datasheet for these.
Note that these sizes do not include the out-of-band/spare area
count. So if a datasheet claims, for instance, a page size of
2048+64 or 2112 bytes, the page size will be 2048.</p></div>
</div>
<div class="sect4">
<h5 id="_sector_size"> -sector_size</h5>
<div class="paragraph"><p>The error correction region size, e.g. when the datasheet
says "8 bit correction per 528Bytes" this means a sector
size of 512 bytes (or e.g. 512+16, due to the spare; see -oob).
Must be either 512 or 1024.</p></div>
</div>
<div class="sect4">
<h5 id="_oob"> -oob</h5>
<div class="paragraph"><p>The NAND chip spare area size, per 512 bytes. Can
be calculated as "spare * 512 / pagesize". e.g., for a 2048+64
page device, this should be:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>    64 * 512 / 2048 = 16</code></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_ecc"> -ecc</h5>
<div class="paragraph"><p>Minimum number of bits correction per sector. For example,
if the datasheet says <em>24-bit correction per 1024 bytes</em>, then
<em>-ecc</em> should be 24.</p></div>
</div>
<div class="sect4">
<h5 id="_flags_2"> -flags</h5>
<div class="paragraph"><p>Currently unused and flagged for possible deprecation.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">when booting from NAND, -ecc, -oob, and -sector_size are
used as a minimum specification&#8201;&#8212;&#8201;BOLT will simply validate that
the board strapping is at least as strong. For non-boot NAND
(e.g., NAND on CS1), -ecc, -oob, and -sector_size are used as the
selected configuration.</td>
</tr></table>
</div>
<div class="paragraph"><p>For non-boot NAND (e.g., on chip select 1), -ecc, -oob, and
-sector_size are used <em>directly</em> to configure the NAND, rather than
just used as a minimum suggestion.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">Don&#8217;t put spaces between the numeric values in the
flag values (see above example.)</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cmdlevel">5.11.  cmdlevel</h3>
<div class="paragraph"><p>Usage: cmdlevel &lt;LEVEL&gt;</p></div>
<div class="paragraph"><p>Note: set BOLT debug level</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>cmdlevel 3</code></pre>
</div></div>
<div class="paragraph"><p>Use this command to set how much debug BOLT produces. level 3
is normal, higher values produce more debug, e.g. 5.</p></div>
</div>
<div class="sect2">
<h3 id="_rtsconfig">5.12.  rtsconfig</h3>
<div class="paragraph"><p>Usage: rtsconfig -id &lt;BOX MODE&gt; -file &lt;FILE&gt;</p></div>
<div class="paragraph"><p>Note: Which RTS file to use. The <em>scb_clk</em> parameter and
 the <em>-default</em> flag have been deprecated.</p></div>
<div class="paragraph"><p>See also: rtsbase rtsdefault</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> rtsconfig -id 1 -file config/family-7445d0-box1.rts
 rtsconfig -id 2 -file config/family-7445d0-box2.rts
 rtsconfig -id 4 -file config/family-7445d0-box4.rts</code></pre>
</div></div>
<div class="paragraph"><p>Choose RTS files to incorporate into the BOLT build.</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;BOX MODE&gt; is a user specified identification number
which must match the <em>box mode</em> that the rts data
was created for. Failure to correctly match this
may result in incorrect NEXUS operaton. A zero (0)
value is illegal.
</p>
</li>
<li>
<p>
&lt;FILE&gt; is the file and path of the rts file to
incorporate into the BOLT build. It is a relative
path from the BOLT build root.
</p>
</li>
</ul></div>
<div class="paragraph"><p>To change the RTS at runtime see the <em>rts</em> command in
the doc/bolt_commands.txt file.</p></div>
</div>
<div class="sect2">
<h3 id="_rtsbase">5.13.  rtsbase</h3>
<div class="paragraph"><p>Usage: rtsbase &lt;MEMC&gt; &lt;ADDRESS&gt;</p></div>
<div class="paragraph"><p>Note: Select an RTS to be programed into a memory controller (memc.)</p></div>
<div class="paragraph"><p>See also: rtsconfig rtsdefault</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>rtsbase 0 MEMC_ARB_0_CLIENT_INFO_0
rtsbase 0 -</code></pre>
</div></div>
<div class="paragraph"><p>You can selectively choose to program, or not, an RTS
for a MEMC. The &lt;ADDRESS&gt; may be a raw address (number)
or a recognised RTS base address, such as that shown in
the first example. The second example show an rts
prevented from being programmed (<em>-</em>).</p></div>
</div>
<div class="sect2">
<h3 id="_dts">5.14.  dts</h3>
<div class="paragraph"><p>Usage: dts &lt;FILE&gt; &lt;LOAD ADDRESS&gt;
       dts -include &lt;FILE&gt;</p></div>
<div class="paragraph"><p>Note: Select a Device Tree file to be used by BOLT.</p></div>
<div class="paragraph"><p>See also: dtsinclude</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>dts config/family-7445a0.dts @ 0x00001000
dts config/family-7445d0.dts</code></pre>
</div></div>
<div class="paragraph"><p>Choose a Device Tree source file (*.dts) that BOLT
will incorporate into its build.</p></div>
<div class="paragraph"><p>The <em>dt bolt</em> user interface command, or
launching a program will modify this file
based on runtime values.</p></div>
<div class="paragraph"><p>dtsinclude</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Usage: dtsinclude -file <FILE>
       dts -include <FILE>

Note: Indicates that Device Tree fragments need to be included by the
family DTS file specified by the "dts" command.

See also: dts

Example:
----
dtsinclude -file config/foo.dts
----

Choose a Device Tree source file (*.dts) that BOLT
will include within the Device Tree source file specified by the
"dts" command. Using this option allows including several Device Tree sources
fragments which can override the family's DTS file.



 dt autogen</code></pre>
</div></div>
<div class="paragraph"><p>Usage: dt autogen -node &lt;NODE&gt; [&lt;OPTS&gt;]</p></div>
<div class="paragraph"><p>Note: Request the bolt build system to autogenerate a Device Tree node.</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node genet</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node usb -ipp 0</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node sdio -choose 1</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node serial -compatible brcm,buggy-dw-apb-uart ns16550a</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node bsc -choose 0,3,4</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node memory -reg 0x0 0x0 0x0 0x10000000</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node clocks -cpu-div-table 0x00 1</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node sdio -undo 1</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node ext_moca -parent qspi -cs 0 -interrupt_parent upg_gio -interrupt 14 4</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">If you use this command (dt autogen), it must be in the "[family]"
 section.  In addition, you must use the <em>dts</em> command first.  The dts
 command specifies the Device Tree textfile to start with, and
 this command will add node(s) to it.  The result can be found
 in ./gen/$(FAMILY)/*.dtx.</td>
</tr></table>
</div>
<div class="paragraph"><p>For all nodes, you can supply the optional option <em>-compatible</em>
to specify a compatibility string other than the default.</p></div>
<div class="paragraph"><p>For all nodes, you can supply the optional option <em>-choose</em>.  It takes
a single argument, and that argument may be a single number or a
comma separated list of numbers (no spaces).  This option allows
you to select only specific devices in the order that they appear
in GISB space.</p></div>
<div class="paragraph"><p>In addition, if a "dt autogen -node foo" is already in the config
file and you would like to remove its effect, just use
dt autogen -node foo -undo 1</p></div>
<div class="sect3">
<h4 id="_bsc_i2c">5.14.1. bsc(i2c)</h4>
<div class="paragraph"><p>If you choose to generate bsc i2c master node supply the option <em>-choose</em>
to choose the master channel to create the node for. Also an optional
<em>-clock-frequency</em> can be provided to set the clock frequency for individual
i2c master controller. If the <em>-clock-frequency</em> option is not used then the
default clock-frequency would be 390000Hz. clock-frequency is a decimal value
of i2c master clock frequency in Hz valid values are 375000, 390000, 187500
and 200000, e.g. Below examples create iica, iicd, iice dt nodes:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node bsc -choose 0,3,4</code></pre>
</div></div>
<div class="paragraph"><p>or</p></div>
<div class="listingblock">
<div class="content">
<pre><code>dt autogen -node bsc -choose 0,3,4 -clock-frequency 375000, 390000, 187500</code></pre>
</div></div>
<div class="paragraph"><p>BSC i2c master channel 0,1,2,3,4,5 correspond to iica, iicb, iicc, iicd, iice.
Based on the platform some of the channels are assinged to UPG block and some
in UPG_AON block, the autogen automatically figures the block the master
belongs to and creates appropriate node.</p></div>
<div class="paragraph"><p>If you choose to generate a usb memory node, you can also use the
options <em>-ipp</em> and <em>-ioc</em>.  Use 0 for active high, 1 for active low.
<em>-ipp</em> also accepts 2 which allows a board strap signal to control
the polarity. If they are not used, the default value will be 1.</p></div>
</div>
<div class="sect3">
<h4 id="_memory">5.14.2. memory</h4>
<div class="paragraph"><p>If you choose to generate a memory node, you must use the additional
option <em>-reg</em>. <em><span class="gray line-through">and <em>-cma</em>.</span></em> <em>-reg</em> specifies the list of register
bands, each pair of 32 bit values (to make a 64 bit value) having
a start and length hex value.  <em><span class="gray line-through">'-cma'
specifies the continuous memory regions, with each region having
a name, a start (hex), and a size (hex). If a name is of the
form <em>region_N</em>, where N is a decimal number, then a cma-dev
node will be created.</span></em></p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content"><span class="red">The <em>-cma</em> option has been removed.</span></td>
</tr></table>
</div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        dt autogen -node memory  -reg 0x0 0x00000000 0x0 0x40000000</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_memcs">5.14.3. memcs</h4>
<div class="paragraph"><p>Usage: dt autogen -node memcs -compatible &lt;COMPAT&gt; -compat_with &lt;WITH&gt;</p></div>
<div class="paragraph"><p>Note: Create all memory (DDR) controller device nodes available</p></div>
<div class="paragraph"><p>See also: dt autogen</p></div>
<div class="sect4">
<h5 id="_options"> Options:</h5>
<div class="ulist"><ul>
<li>
<p>
<strong>COMPAT</strong> - For all DDR controllers (0..N) this sets the <em>memc@</em>&lt;N&gt; device node
<em>and all of its sub-nodes</em> (ddr-phy, shimphy, memc-ddr) compatibility property
string for possible use by a Linux driver. The default is to source the
compatibility values from the register database (RDB) so as to extract the right
hardware block revision numbers. Unless you have a special requirement it is
<strong>not recommended</strong> to use this option.
</p>
</li>
<li>
<p>
<strong>WITH</strong> - This allows the selective <strong>addition</strong> of user specified strings to
a specific nodes compatibility property. The format of the data is one or more
space separated [key]=[value] pairs with no spaces within the pair. Currently,
only the <em>ddr-phy</em> key is defined.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        dt autogen -node memcs</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>        dt autogen -node memcs -compat_with ddr-phy=brcm,brcmstb-ddr-phy-v240.2</code></pre>
</div></div>
<div class="paragraph"><p>The root nodes for each controller resides at <em>/rdb/memory_controllers/memc@&lt;N&gt;</em>, e.g.</p></div>
<div class="listingblock">
<div class="content">
<pre><code>BOLT&gt; dt show mem -nodes
DTB @ 0x7822000
/dts-v1/;

/       memc-cma-mapping
        memory_controllers
                memc@0
                        ddr-phy@f0506000
                        shimphy@f0508000
                        memc-ddr@f0502000
                memc@1
                        ddr-phy@f0906000
                        shimphy@f0908000
                        memc-ddr@f0902000
*** command status = 0</code></pre>
</div></div>
<div class="paragraph"><p>The example below shows the results of using <em>-compat_with <strong>ddr-phy</strong>=brcm,brcmstb-ddr-phy-v240.2</em>
in which the default <em>compatible</em> property is "brcm,brcmstb-ddr-phy-v240.4"</p></div>
<div class="listingblock">
<div class="content">
<pre><code>BOLT&gt; dt show ddr-phy@f0506000
DTB @ 0x7822000
/dts-v1/;

/       ddr-phy@f0506000 {
                compatible = "brcm,brcmstb-ddr-phy-v240.4", "brcm,brcmstb-ddr-phy-v240.2";
                reg = &lt;0xf0506000 0x21c&gt;;
        };
*** command status = 0</code></pre>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_clocks">5.14.4. clocks</h4>
<div class="paragraph"><p>If you choose to generate a <em>clocks</em> node, you must add the <em>-cpu-div-table</em>
option. <em>-cpu-div-table</em> specifies the allowed CPU clock divider settings
for the platform. The parameters for the <em>-cpu-div-table</em> option are integers,
arranged as a list of ordered-pairs, &lt;div_setting div&gt;, where:</p></div>
<div class="paragraph"><p>&lt;div_setting&gt; = raw value to write into HIF_CPUBIUCTRL_CPU_CLOCK_CONFIG_REG,
&lt;div&gt; = the logical clock divider setting.</p></div>
<div class="paragraph"><p>It is not recommended to change the Broadcom-provided defaults of "0x00 1" (no
quotes).</p></div>
<div class="paragraph"><p>This property is no longer used for configuring Linux&#8217;s cpufreq driver, but it
is important that Linux can restore any divider setting configured by the
SSBL.</p></div>
</div>
<div class="sect3">
<h4 id="_sata">5.14.5. sata</h4>
<div class="paragraph"><p>If you choose to generate a <em>sata</em> node, you may optionally
define the following options: <em>-phy-enable-ssc-mask</em>.</p></div>
<div class="paragraph"><p>The <em>-phy-enable-ssc-mask</em> option takes in a hexadecimal value,
where the least-significant bit corresponds to port 0. A bit value
of <em>1</em> means that spread-spectrum clocking will be enabled on the
associated SATA port once the Linux SATA driver is loaded.</p></div>
<div class="paragraph"><p>For example, to enable SSC on SATA ports 0, and 1, the autogen
entry will be:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>        dt autogen -node sata -phy-enable-ssc-mask 0x3</code></pre>
</div></div>
<div class="paragraph"><p>More information about the SATA DT binding can be found at in the
kernel sources, under <em>Documentation/devicetree/bindings/ata/brcm-sata.txt</em>.</p></div>
<div class="paragraph"><p>If you use this command (dt autogen), it must be in the "[family]"
section.  In addition, you must use the <em>dts</em> command first.  The dts
command specifies the Device Tree textfile to start with, and
this command will add node(s) to it.  The result can be found
in ./gen/$(FAMILY)/*.dtx.</p></div>
</div>
<div class="sect3">
<h4 id="_syscon">5.14.6. syscon</h4>
<div class="paragraph"><p>The following <em>syscon</em> nodes: pinmux, padmux, aon_pinmux,
aon_padmux memc_client_info, sdio_syscon and
sun_top_ctrl_general_ctrl and sun_top_ctrl_general_ctrl_no_scan
can accept a reference parameter that will list them by phandle
in a separate node.</p></div>
<div class="paragraph"><p>E.g. the default is to list these in the <em>s3</em> node
by adding the extra dt autogen parameter "-ref s3".</p></div>
<div class="paragraph"><p>In addition, the sun_top_ctrl_general_ctrl node
will have all members of it, or a single one by
specifying a numerical "-sel" value, e.g. "-sel 0"
to select the BCHP_SUN_TOP_CTRL_GENERAL_CTRL_0
register (or equivalent.). The same rules apply to the
sun_top_ctrl_general_ctrl_no_scan node(s).</p></div>
</div>
<div class="sect3">
<h4 id="_nexus">5.14.7. nexus</h4>
<div class="paragraph"><p>The nexus-wakeups node is regarded if the <em>-parent</em> property
is specified, otherwise no "nexus-wakeups" dt node will be
created. This property must match (it is converted to
uppercase beforehand) an RDB L2 interrupt register that is
to be inspected for bit values. The bit values are specified
by the <em>-uses</em> argument, space separated case sensitive values
that must match the bits in the RDB register of the <em>-parent</em>
value. Bits that are not present in the actual RDB are ignored.</p></div>
</div>
<div class="sect3">
<h4 id="_serial">5.14.8. serial</h4>
<div class="paragraph"><p>Usage: dt autogen -node serial -compatible &lt;COMPAT&gt; -name &lt;NAME&gt; -l1intr &lt;L1&gt; -alias &lt;ALIAS&gt; -stdout &lt;CON&gt;</p></div>
<div class="paragraph"><p>Note: Create uart (serial port) device nodes.</p></div>
<div class="paragraph"><p>See also: dt autogen</p></div>
<div class="sect4">
<h5 id="_options_2"> Options:</h5>
<div class="ulist"><ul>
<li>
<p>
<strong>COMPAT</strong> - This sets the uart device compatibility configuration
within the Linux driver. See the <em>of-serial.txt</em> and <em>brcm-broken-dw-apb-uart.txt</em>
files in the <em>linux/Documentation/devicetree/bindings/serial</em> directory of your
Broadcom Linux distribution for a full list. The most common setting are:
</p>
<div class="ulist"><ul>
<li>
<p>
<em>ns16550a</em> - Standard for Broadcom chips.
</p>
</li>
<li>
<p>
<em>brcm,buggy-dw-apb-uart</em> - For older chips.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<strong>NAME</strong> - The RDB name of the device, e.g. <em>UART</em> from BCHP_UART_REG_START.
</p>
</li>
<li>
<p>
<strong>L1</strong> - The RDB interrupt name, e.g. <em>UART_RG</em> from BCHP_HIF_CPU_INTR1_INTR_W2_MASK_STATUS_UART_RG_CPU_INTR_SHIFT
</p>
</li>
<li>
<p>
<strong>ALIAS</strong> - A unique name to refer the uart by in the <em>alias</em> Device Tree node. It should have the prefix
"serial_" e.g. <em>serial_rg</em>
</p>
</li>
<li>
<p>
<strong>CON</strong> - Set the default Linux boot console uart. The <em>-stdout</em> flag takes a single
letter (A, B, C etc.) It may be specified only  <strong>once</strong>. <span class="red">This option has no
effect whatsoever with respect which uart the BOLT console uses</span>.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">if <em>-stdout</em> is specified then the default baud rate is acquired from the
SERIAL_BAUD_RATE configuration in <em>config/stdbuild.cfg</em> and applied to the uart node
designated as the Linux console, otherwise the default uart and baud rate within the
Linux kernel are used.</td>
</tr></table>
</div>
<div class="paragraph"><p>There are two forms of this command, <strong>Standard</strong> and <strong>System specific</strong>:</p></div>
</div>
<div class="sect4">
<h5 id="_standard"> Standard</h5>
<div class="literalblock">
<div class="content">
<pre><code>dt autogen -node serial -compatible  &lt;COMPAT&gt; -stdout &lt;CON&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Broadcom provides a standard set of "UPG_UART"s intended for general system use.
UART <em>A</em> is required by our reference software to be the default for Linux (and BOLT)
console i/o. Only the optional <em>-compatible</em> and <em>-stdout</em> flags may be specified with
this form of the command, <em>-name</em>, <em>-l1intr</em> and <em>-alias</em> are ignored. This command only
needs to be done <em>once</em> for all the standard "UPG_UART" uart nodes to be populated.</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  dt autogen -node serial -compatible ns16550a -stdout B</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>  dt autogen -node serial</code></pre>
</div></div>
</div>
<div class="sect4">
<h5 id="_system_specific"> System specific</h5>
<div class="literalblock">
<div class="content">
<pre><code>dt autogen -node serial -compatible &lt;COMPAT&gt; -name &lt;NAME&gt; -l1intr &lt;L1&gt; -alias &lt;ALIAS&gt;</code></pre>
</div></div>
<div class="paragraph"><p>There may be other uarts in the system that you may wish to add. These are often chip
specific and not uniformly named/specified and hence have to be added one by one. This
form of the command may be repeated for each additional uart of interest, as well as of
course having  <em>one</em> of the <em>standard</em> form of this command for all the "UPG_UART"s.</p></div>
<div class="paragraph"><p>The <em>-stdout</em> flag is ignored and <em>-compatible</em> is optional. <em>-name</em>, <em>-l1intr</em>
and <em>-alias</em> are <span class="underline">mandatory</span>.</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  dt autogen -node serial -compatible ns16550a -name UART -l1intr UART_RG -alias serial_rg</code></pre>
</div></div>
</div>
</div>
<div class="sect3">
<h4 id="_bsp">5.14.9. bsp</h4>
<div class="paragraph"><p>Usage: dt autogen -node bsp</p></div>
<div class="paragraph"><p>Note: Provide the security version to Linux for e.g. decisions with regard to power management.</p></div>
<div class="paragraph"><p>See also: dt autogen</p></div>
<div class="paragraph"><p>Options: BSP does not take any arguments.</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  dt autogen -node bsp</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_thermal_zones">5.14.10. thermal_zones</h4>
<div class="paragraph"><p>Usage: dt autogen -node thermal_zones -thermal-sensors &lt;phandle&gt; [-trips TEMP0 HYST0 [TEMP1 HYST1 [&#8230;]]]</p></div>
<div class="paragraph"><p>Sets up the top-level <code>thermal-zones</code> node to describe the relationship between
sensor(s) and trip point(s). Requires at least a phandle to a thermal sensor
(e.g., <code>avs_tmon</code>). Trip points can be optionally configured via the <code>-trips</code>
option. Trip points must come in pairs, consisting of a temperature value and a
hysteresis. Hysteresis may be zero, if desired. It is highly recommended you
consult Broadcom before changing the trip points away from their defaults.</p></div>
<div class="paragraph"><p>Device Tree binding reference: <a href="https://www.kernel.org/doc/Documentation/devicetree/bindings/thermal/thermal.txt">https://www.kernel.org/doc/Documentation/devicetree/bindings/thermal/thermal.txt</a></p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  dt autogen -node thermal_zones -thermal-sensors avs_tmon -trips 110000 10000 125000 10000</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_cpuclock">5.14.11. cpuclock</h4>
<div class="paragraph"><p>Usage: dt autogen -node cpuclock -clocks &lt;phandle&gt; [-clock-latency NS]</p></div>
<div class="paragraph"><p>Adds a <code>clocks</code> phandle to the CPU node, for dynamic frequency scaling. May
also provide a clock latency, in nanoseconds.</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  dt autogen -node cpuclock -clocks cpu_mdiv_ch0 -clock-latency 4800</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_gpio">5.14.12. gpio</h4>
<div class="paragraph"><p>Usage: dt autogen -node gpio</p></div>
<div class="paragraph"><p>Creates device nodes for available GPIO controllers; currently only generates
nodes for UPG GIO and GIO_AON.</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  dt autogen -node gpio</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_watchdog">5.14.13. watchdog</h4>
<div class="paragraph"><p>Usage: dt autogen -node watchdog -type &lt;NAME&gt;</p></div>
<div class="paragraph"><p>Creates device node for the watchdog timers. The watchdog type is required.
You may specify multiple watchdogs.</p></div>
<div class="paragraph"><p>Current watchdogs:
upg             0
webhif          1
hyper           2</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  dt autogen -node watchdog -type upg webhif</code></pre>
</div></div>
</div>
<div class="sect3">
<h4 id="_ext_moca">5.14.14. ext_moca</h4>
<div class="paragraph"><p>Usage: dt autogen -node ext_moca -parent &lt;PARENT&gt; -cs &lt;CS_NUM&gt;
        -interupt_parent &lt;INTERRUPT_PARENT&gt; -interrupt &lt;INTERRUPT_SPECIFIER&gt;
        -frequency &lt;FREQ&gt; -spi-clock-polarity &lt;0|1&gt; -spi-clock-phase &lt;0|1&gt;</p></div>
<div class="paragraph"><p>External MoCA chips such as Broadcom&#8217;s BCM6802/3 are typically interfaced
through SPI and require indicating which SPI controller the chip is attached to
(PARENT, typically UPG_MSPI, aka qspi in Device Tree) and the chip select
number (CS_NUM). It is also necessary to indicate the interrupt controller
(INTERRUPT_PARENT) and interrupt specifier (INTERRUPT_SPECIFIER) that is used.</p></div>
<div class="paragraph"><p>The maximum supported frequency can be defined using FREQ and the SPI clock
polarity and phase polarity can be defined as well.</p></div>
</div>
<div class="sect3">
<h4 id="_points_to_regard_with_respect_to_usb">5.14.15.  Points to regard with respect to USB</h4>
<div class="ulist"><ul>
<li>
<p>
Instead of using the register database (RDB) to source
the base register addresses to setup USB, BOLT now
sources them via Device Tree, just like Linux does.
</p>
</li>
<li>
<p>
If you do not have USB device nodes in your Device Tree
then the BOLT USB driver WILL NOT be initialized.
</p>
</li>
<li>
<p>
The Broadcom specific Device Tree properties
<em>ioc</em> (Invert Over-Current) and <em>ipp</em> (Invert Port Power)
are read from the Device Tree as well, note that these
options are settable at build time by the autogen command
(see above) and can be overridden at runtime by the
USBIPP and USBIOC environment variables. Note that the
environment variables also affect the Device Tree so that
BOLT and Linux USB setting match.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_i2cbus">5.15.  i2cbus</h3>
<div class="paragraph"><p>Usage: i2cbus [BUS]</p></div>
<div class="paragraph"><p>Note: Select I2C bus for finding a board ID</p></div>
<div class="paragraph"><p>See also: bid</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> i2cbus BSCF</code></pre>
</div></div>
<div class="paragraph"><p>Some reference platforms have an I2C device that holds an 8-bit
number matched to that specific board type. If BOLT has been
build to detect that number and the device exists on the
board then the number is read in and a match is attempted
between that number and one assigned in the config script for
it (see bid command.) This command sets which I2C bus to
go looking for the board ID.</p></div>
<div class="paragraph"><p>It is represented by UPPERCASE text matching a register
database (RDB) file. In the above example that would
be the file bolt/include/&lt;FAMILY&gt;/bchp_bscf.h</p></div>
<div class="paragraph"><p>Note that this is a new feature to support Broadcom
reference boards and may change in future releases.</p></div>
</div>
<div class="sect2">
<h3 id="_include">5.16.  include</h3>
<div class="paragraph"><p>Usage: include &lt;FILE&gt;</p></div>
<div class="paragraph"><p>Note: include an external config file</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>include stdbuild.cfg</code></pre>
</div></div>
<div class="paragraph"><p>Include (inline) from another file.</p></div>
</div>
<div class="sect2">
<h3 id="_ldfile">5.17.  ldfile</h3>
<div class="paragraph"><p>Usage: ldfile -in file.in [-rename outfile]</p></div>
<div class="paragraph"><p>Note: Copy and perform substitutions on a named file.</p></div>
<div class="paragraph"><p>See also: cset gset</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>ldfile -in config/fsbl.lds.in
ldfile -in config/mysection.lds.in -rename mysection.lds</code></pre>
</div></div>
<div class="paragraph"><p>This command will copy a file from a source file + path to
the BOLT build directory (stripping the original path in the
process) and perform substitutions on that copy.</p></div>
<div class="ulist"><ul>
<li>
<p>
The substitutions will replace any text delimited (bracketed)
by <em>@</em> e.g. @FILLB@, with those defined by the gset or cset
commands.
</p>
</li>
<li>
<p>
If the optional -rename flag is not specified then any
appended <em>.in</em> file name postfix is stripped, e.g. <em>fsbl.lds.in</em>
will become <em>fsbl.lds</em>.
</p>
</li>
<li>
<p>
For the optional -rename flag being specified the target
file name is sans path or <em>.in</em> postfix,
e.g. <em>-rename mysection.lds</em>.
</p>
</li>
<li>
<p>
There is a special case if <em>MEMC_ALT</em> is defined by get or cset.
If an input file is named <em>memsys.lds</em> then an output file called
<em>memsys_alt.lds</em> will also be created by BOLT in the object directory.
This auto-created file will have any text <em>memsys</em> in it replaced by
<em>memsys_alt</em>.
</p>
</li>
<li>
<p>
<em><span class="red">This command configures part of the BOLT build system (mostly
linker scripts) and it is not recommended to change anything without
due consideration.</span></em>
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">The output directory is <em>objs/$(FAMILY)</em> and not <em>gen/$(FAMILY)</em>.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_comment">5.18.  comment</h3>
<div class="paragraph"><p>Usage: comment &lt;string&gt;</p></div>
<div class="paragraph"><p>Note: Add a comment to the FSBL board selection menu</p></div>
<div class="paragraph"><p>See also:  [board] [chip], the file <em>include/fsbl-common.h</em></p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>comment Placeholder board with spi boot</code></pre>
</div></div>
<div class="paragraph"><p>The comment is the text you see in the brackets
at the FSBL board selection menu. Its limited to
NAMELEN characters.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content"><strong>* USE IS NOW DEPRECATED </strong>*</td>
</tr></table>
</div>
<div class="paragraph"><p>No comments will be shown in the FSBL board selection menu.</p></div>
</div>
<div class="sect2">
<h3 id="_enet">5.19.  enet</h3>
<div class="paragraph"><p>Usage: enet -genet &lt;NUMBER&gt; -phy_type &lt;PHY&gt; -mdio_mode &lt;MODE&gt; -phy_speed &lt;SPEED&gt; -phy_id &lt;ID&gt; -ethsw &lt;HEXSTR&gt;</p></div>
<div class="paragraph"><p>Note: Set ethenet parameters.</p></div>
<div class="paragraph"><p>See also: [board] [chip], BOLT <em>ephycfg</em> command.</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>enet -genet 0 -phy_type INT -mdio_mode 1 -phy_speed 1000 -phy_id 10
enet -genet 0 -phy_type -   -mdio_mode - -phy_speed -    -phy_id -
enet -switch_port 0 -phy_type INT -mdio_mode 1 -phy_speed 1000 -phy_id 5
enet -switch_port 7 -phy_type MOCA -mdio_mode - -phy_speed 1000 -phy_id 257</code></pre>
</div></div>
<div class="paragraph"><p>This sets the internal Ethernet (not USB Ethernet)
configuration for a board. Note that running the
BOLT <em>ephycfg</em> command sets environment variables
which will override the board defaults you set with
this build script command.</p></div>
<div class="paragraph"><p>A <em>'</em>-<em>'</em> value unsets the parameter the board will use
and will REMOVE its Device Tree entry (property) from
its corresponding <a href="mailto:ethernet@xxxxxxxx">ethernet@xxxxxxxx</a> node.</p></div>
<div class="paragraph"><p>A special case is for phy_type, where if &lt;PHY&gt; is <em>'</em>-<em>'</em> then
the complete <a href="mailto:ethernet@xxxxxxxx">ethernet@xxxxxxxx</a> node will be REMOVED from
Device Tree.</p></div>
<div class="paragraph"><p>Only <em>-genet</em> and <em>-switch_port</em> are required parameters,
but for the physical eth/genet/switch port device (if enabled in the build)
that BOLT can use all values.</p></div>
<div class="sect3">
<h4 id="_parameters">5.19.1. Parameters</h4>
<div class="sect4">
<h5 id="_genet">genet</h5>
<div class="paragraph"><p>genet &lt;NUMBER&gt; - The physical GENET number as it
appears in the register database (RDB) for each
chip. e.g. 0, 1 or 2 for 7445.</p></div>
</div>
<div class="sect4">
<h5 id="_switch_port">switch_port</h5>
<div class="paragraph"><p>switch_port &lt;NUMBER&gt; - The physical integrated switch port number
as it appears in the register database (RDB) for each
chip. e.g: 0 to 7 for 7445 (8 is reserved).</p></div>
</div>
<div class="sect4">
<h5 id="_phy_type">phy_type</h5>
<div class="paragraph"><p>phy_type &lt;PHY&gt; - The phy configuration value.
The following types have meaning to the single
physical device BOLT can use as well as for
Device Tree:</p></div>
<div class="ulist"><ul>
<li>
<p>
INT - (1) internal PHY
</p>
</li>
<li>
<p>
MII - (2) 10/100 MII (18-wire interface)
</p>
</li>
<li>
<p>
RGMII - (4) 14-wire RGMII interface.
</p>
</li>
<li>
<p>
RGMII_NO_ID - (6) same as above, but disable phase shift on TXC clock
</p>
</li>
</ul></div>
<div class="paragraph"><p>The following types only have meaning for Device Tree
and are not valid for physical devices:</p></div>
<div class="ulist"><ul>
<li>
<p>
RVMII - (3) 14-wire RGMII interface.
</p>
</li>
<li>
<p>
RGMII_IBS - (5) 14-wire RGMII interface.
</p>
</li>
<li>
<p>
MOCA - (7) MoCA
</p>
</li>
</ul></div>
<div class="paragraph"><p>Note that the value of &lt;PHY&gt; is case sensitive.</p></div>
</div>
<div class="sect4">
<h5 id="_mdio_mode">mdio_mode</h5>
<div class="paragraph"><p>mdio_mode &lt;MODE&gt; -  The mdio configuration value.</p></div>
<div class="ulist"><ul>
<li>
<p>
0 - standard MDIO is not available e.g. connected to a BCM3383.
</p>
</li>
<li>
<p>
1 - (default) standard MDIO is available (Ethernet PHY)
</p>
</li>
<li>
<p>
boot - BOLT configure it only e.g. linked to an Ethernet switch.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">This applies only to the physical device BOLT can use,
not the Device Tree entries as that will result in undefined values.</td>
</tr></table>
</div>
<div class="paragraph"><p>More info:  <a href="http://en.wikipedia.org/wiki/Management_Data_Input/Output">http://en.wikipedia.org/wiki/Management_Data_Input/Output</a></p></div>
</div>
<div class="sect4">
<h5 id="_phy_speed">phy_speed</h5>
<div class="paragraph"><p>phy_speed &lt;SPEED&gt; - Ethernet speed value. Typical values are:</p></div>
<div class="ulist"><ul>
<li>
<p>
100
</p>
</li>
<li>
<p>
1000
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_phy_id">phy_id</h5>
<div class="paragraph"><p>phy_id &lt;ID&gt; - The id or address of a connected PHY.</p></div>
<div class="ulist"><ul>
<li>
<p>
probe - probe for an EXTERNAL phy address.
</p>
</li>
<li>
<p>
noprobe - set to 32
</p>
</li>
<li>
<p>
&lt;value&gt; - set to &lt;value&gt;
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">Do NOT use these values for any other device apart from the
physical <em>eth</em> device BOLT (may) use. Any [non]probed value will
be set in ETH0_PHYPROBE_ID after <em>dt bolt</em> command or
when booting Linux. A value of -1 indicates a failure in probing.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">If the  phy id/address for ID_AUTO is 256 (0x100) and
ID_NONE is 257 (0x101). Do not use hexadecimal values for these in
the config script."probe" and "noprobe" applies only to the physical
device BOLT can use, not the Device Tree entries as that will result
in undefined values.</td>
</tr></table>
</div>
<div class="paragraph"><p>For the physical device BOLT uses, then for the case of "probe"
failing the Device Tree value will be set to ID_NONE.</p></div>
</div>
<div class="sect4">
<h5 id="_ethsw">ethsw</h5>
<div class="paragraph"><p>ethsw &lt;HEXVAL&gt;
 A HEX number for specifying the switch type the GENET or
integrated switch port  is connected to. It has no meaning
for the BOLT physical Ethernet device, only for Linux (Device Tree).</p></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_moca">5.20.  moca</h3>
<div class="paragraph"><p>Usage: moca -enet_node &lt;DT_NODE&gt; -moca_band &lt;BAND&gt;</p></div>
<div class="paragraph"><p>Note: Set MoCA parameters.</p></div>
<div class="paragraph"><p>See also: [board] [chip].</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> moca -enet_node eth1 -moca_band highrf</code></pre>
</div></div>
<div class="paragraph"><p>This sets the internal MoCA configuration for a board.</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>-enet_node</em> is an alias to the Ethernet Device Tree node
which provides the data-path for the MoCA hardware block.
</p>
</li>
<li>
<p>
<em>-moca_band</em> applies to MoCA devices
in Device Tree, its ignored otherwise. It is a
string representing a band as follows:
</p>
</li>
</ul></div>
<div class="listingblock">
<div class="content">
<pre><code>        band
        ----
        highrf (deprecated, use 'ext_d' instead)
        midrf  (deprecated, use 'e' instead)
        wanrf  (deprecated)
        ext_d  (1125 ~ 1625 MHz)
        d_low  (1125 ~ 1225 MHz)
        d_high (1350 ~ 1625 MHz)
        e      ( 500 ~  600 MHz)
        f      ( 675 ~  850 MHz)
        g      (   0 ~ 1600 MHz)
        h      ( 975 ~ 1025 MHz)</code></pre>
</div></div>
<div class="paragraph"><p>This is only used as a Device Tree configuration entry for Linux.</p></div>
</div>
<div class="sect2">
<h3 id="_ext_moca_2">5.21.  ext_moca</h3>
<div class="paragraph"><p>Usage: ext_moca -enet_node &lt;DT_NODE -moca_band &lt;BAND&gt;
        -rgmii &lt;RGMII 0|1&gt; -phy_type &lt;PHY_TYPE&gt; -phy_id &lt;PHY_ID&gt;
        -mdio_mode &lt;MDIO_MODE&gt;</p></div>
<div class="paragraph"><p>Note: Set External MoCA parameters (e.g: Broadcom BCM6802/3) for its
two RGMII interfaces.</p></div>
<div class="paragraph"><p>See also: [moca] [enet]</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> ext_moca -enet_node eth1 -rgmii 0 -phy_type MOCA -mdio_mode 0 -phy_speed 1000
 -phy_id 257</code></pre>
</div></div>
<div class="paragraph"><p>This sets up the external MoCA configuration for a board.</p></div>
<div class="ulist"><ul>
<li>
<p>
<em>-enet_node</em> is an alias to the Ethernet Device Tree node
which provides the data-path for the MoCA hardware block.
</p>
</li>
<li>
<p>
<em>-moca_band</em> applies to MoCA devices
in Device Tree, its ignored otherwise. It is a
string representing a band as described in [moca]
</p>
</li>
<li>
<p>
For all other properties see [enet]
</p>
</li>
</ul></div>
<div class="paragraph"><p>Command: pinmux</p></div>
<div class="paragraph"><p>Note: DEPRECATED from configuration file version 1.6, use pmux instead.</p></div>
<div class="paragraph"><p>See also: pmux</p></div>
</div>
<div class="sect2">
<h3 id="_pmux">5.22.  pmux</h3>
<div class="paragraph"><p>Usage: pmux -pin &lt;pin&gt; -sel &lt;field&gt; [-pull &lt;none|up|down&gt;] [-n &lt;int&gt;]</p></div>
<div class="paragraph"><p>See also: [family] [chip] [board]</p></div>
<div class="paragraph"><p>Note: sets pinmuxing and pad control.  Also: supplants the pinmux command.</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>pmux -pin aon_gpio_07 -sel led_ls_3
pmux -pin aon_gpio_06,aon_gpio_07 -sel led_ls -n 2
pmux -pin aon_gpio_04:aon_gpio_07 -sel led_ls -n 4
pmux -pin gpio -sel sd_card0 -n 12 -pull up
pmux -pin bnm_gpio -sel bnm_led -n 8
pmux -pin pcie1_clkreqb -sel __NONE__ -pull up -n 0 /* see NOTE below */</code></pre>
</div></div>
<div class="paragraph"><p>Set up pinmuxing. If this is specified under [family]
        then it will be hard wired into the FSBL. This is for
        such things as UART.
If specified under [chip] (to be inherited by boards)
        or [board] then it is board specific and actioned in
        the SSBL.</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;pin&gt; matches the gpio pin.  You can specify the full name of the
        pin (e.g. gpio_007), a list of pins (gpio_005,gpio_006_gpio_007),
        or a range of pins (gpio_005:gpio_007).  You can also just use
        <em>gpio</em>, <em>aon_gpio</em>, or <em>bnm_gpio</em>, and just let Bolt&#8217;s pattern
        matching abilities do the matching.
</p>
</li>
<li>
<p>
&lt;val&gt; matches the field value you want to match to connect to the
        specified pin.  This value will be converted to upper case
        during the match.  You only have to give enough of the match
        for it to uniquely identify the matching field, although you
        can only omit characters from the end.  For example, if you
        want to match <em>SD_CARD0_DATA0</em>, <em>SD_CARD0_CLK</em>, &#8230;, you can
        specify <em>sd_card0</em>, but specifying <em>card0</em> will not work.
</p>
</li>
<li>
<p>
&lt;n&gt; is used to specify how many pin matches this statement will
        make.  By default it is 1.  If you match more than 1, you
        will need to use this parameter or you will get an error.
</p>
</li>
<li>
<p>
&lt;pull&gt; is the pad control of the pin.  Specify <em>up</em>, <em>down</em>, or
        none.  This parameter is optional.
</p>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">there are some "dedicated" gpio pins that do not have an RDB
        field for the GPIO but do have a field for its pad cntl.
        In this special case, one must specify <em>-n 0</em> and also
        <em>-sel <em>NONE</em></em>.  The value for <em>-pin</em> should not include
        the <em>pad_ctrl</em> suffix.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_ddr">5.23.  ddr</h3>
<div class="paragraph"><p>Usage: ddr -n &lt;WHICH&gt; -size_mb &lt;SIZE&gt; [-base_mb &lt;BASE&gt;] -clk &lt;SHMOO SPEED&gt; -size_bits &lt;SHMOO SIZE&gt; -width &lt;SHMOO WIDTH&gt; -phy &lt;PHY WIDTH&gt; -fixed - -custom &lt;TAG&gt;</p></div>
<div class="paragraph"><p>Note: Set ddr parameters</p></div>
<div class="paragraph"><p>See also: [board] [chip] [mmap]</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>ddr -n 0 -size_mb 1024 -clk 933MHz -size_bits 4G -width 16 -phy 32
ddr -n 1 -size_mb  -   -clk -      -size_bits -  -width -  -phy -</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">The <code>-base_mb</code> option is deprecated.  Please see <a href="#mmap">[mmap]</a>.</td>
</tr></table>
</div>
<div class="paragraph"><p>The value are inheritable from [chip] and can be overridden. The second
example shows a ddr excluded from being shmoo&#8217;d &amp; will not appear in
the cpu memory map.</p></div>
<div class="paragraph"><p>These parameters select which <em>shmoo</em> table in FSBL to program
the (optimal) settings for a physical ddr device. The values must match
one of those seen in shmoo/${MEMC_REV}/mcb/*.mcb for your chip family.
MEMC_REV is specified in your chip family configuration file.</p></div>
<div class="paragraph"><p>The values &lt;SHMOO SPEED&gt;, &lt;PHY WIDTH&gt;, &lt;SHMOO SIZE&gt; and &lt;SHMOO WIDTH&gt;
appear in order, in the name of the source data files used in bolt, e.g.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> bolt/shmoo/B120_E101/mcb/memsys_config_1067MHz_16b_dev4Gx16_le.mcb</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
&lt;WHICH&gt; is an index to select which <em>memc</em> (ddr controller) to apply the
 <em>shmooing</em> to.
</p>
</li>
<li>
<p>
&lt;SIZE&gt; and &lt;BASE&gt; refer to the physical ddr size and base address in
Mbytes that the cpu will see.
</p>
</li>
<li>
<p>
&lt;SHMOO SPEED&gt; is the ddr speed required.
</p>
</li>
<li>
<p>
&lt;SHMOO SIZE&gt; is the size of the ddr device, e.g. use 4 for a 4Gbit device.
</p>
</li>
<li>
<p>
&lt;SHMOO WIDTH&gt; is each individual ddr chips data bus width, e.g. 8, 16 or 32.
</p>
</li>
<li>
<p>
&lt;PHY WIDTH&gt; is the memc (ddr controller) interface width, e.g. 16 or 32.
</p>
</li>
</ul></div>
<div class="paragraph"><p>If you cannot find a ddr type (aka <em>mcb</em> file) in the BOLT release
package that matches your products actual ddr device, then please
contact your Broadcom FAE.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">A further build step may or may not be required to integrate new
 mcb data files, depending upon BOLT version. Please see the BOLT
documentation doc/howto_update_ddr_mcb_files.txt.</td>
</tr></table>
</div>
<div class="paragraph"><p>The optional flag <em>-fixed</em> (note its required parameter is <em>-</em>,
unused/empty at the moment) automatically enables a BOLT build where
the MCB for shmooing is sourced from within the MEMSYS section of BOLT.</p></div>
<div class="paragraph"><p>If this flag is set then the compressed MCB table in the shmoo
section is still built but it is disabled (memsys MCB tables have
priority.) Even if MCB tables for each DDR are exactly the same
they will occupy their own space in the MEMSYS section of BOLT.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">For a fixed MCB table the ordering of MCB tables,
and hence which MEMC controller/ddr it is intended for, is by
the order of the occurence of each <em>ddr</em> command encountered
in the script.</td>
</tr></table>
</div>
<div class="paragraph"><p>The memsys MCB tables are NOT compressed i.e. full MCB data,
and must fit within the section size as dictated by
config/layout.cfg - or whatever layout is chosen if you decide to
change it.</p></div>
<div class="paragraph"><p>The number of these full sized MCB tables must be no more than the
number of DDR client hardware (<em>MEMC</em>) the chip supports.</p></div>
<div class="paragraph"><p>The optional flag <em>-custom</em> selects a customized MCB based on &lt;TAG&gt;
on top of &lt;SHMOO SPEED&gt;, &lt;SHMOO SIZE&gt;, &lt;SHMOO WIDTH&gt; and &lt;PHY WIDTH&gt;.
The "-custom" flag is specific to each chip family, and corresponding MCB
can be found from shmoo/${MEMC_REV}/mcb/${FAMILY}/&lt;TAG&gt;*.mcb, e.g.</p></div>
<div class="listingblock">
<div class="content">
<pre><code> bolt/shmoo/B120_E101/mcb/74371a0/nocs1_800MHz_16b_dev4Gx16_le.mcb</code></pre>
</div></div>
<div class="paragraph"><p>Customized MCBs should be considered as supplements to MCBs in
shmoo/${MEMC_REV}/mcb/. If only customized MCBs are integrated when
porting BOLT to a customer platform, the customized MCBs should be
placed under shmoo/${MEMC_REV}/mcb/, not shmoo/${MEMC_REV}/mcb/${FAMILY}/</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">Customized MCBs are not supported for secure boot builds.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">The length of &lt;TAG&gt; should be less than or equal to (DDR_TAGLEN-1)
(see include/fsbl-common.h), e.g. if DDR_TAGLEN was 9, then its maximum
length would be 8 characters. Also, &lt;TAG&gt; cannot contain <em>_</em> (underscore)
since it is used as the token separator.</td>
</tr></table>
</div>
<div class="paragraph"><p>Good:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> nocs5678_800MHz_16b_dev4Gx16_le.mcb</code></pre>
</div></div>
<div class="paragraph"><p>Bad:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>nocs56789_800MHz_16b_dev4Gx16_le.mcb</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">If you WANT to be able to select and change MCBs (ddr parameters)
via the FSBL menu then DO NOT specify <em>-fixed</em> or <em>-custom</em> for this
command (ddr) anywhere in your config.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_bid">5.24.  bid</h3>
<div class="paragraph"><p>Usage: bid &lt;hex value&gt;</p></div>
<div class="paragraph"><p>Note: Set the board ID</p></div>
<div class="paragraph"><p>See also: i2cbus</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> bid 0x45</code></pre>
</div></div>
<div class="paragraph"><p>This sets the 8-bit board ID number that BOLT uses to
automatically select the board, without stopping at the
first stage bootloader (FSBL) menu. If no boards match
an ID then the menu is presented.</p></div>
</div>
<div class="sect2">
<h3 id="_dt">5.25.  dt</h3>
<div class="paragraph"><p>Usage:</p></div>
<div class="ulist"><ul>
<li>
<p>
dt cull -root &lt;ROOT&gt; -node &lt;NODE&gt; -prop &lt;PROP&gt;
</p>
</li>
<li>
<p>
dt mac  -root /      -node &lt;NODE&gt;
</p>
</li>
<li>
<p>
dt prop -root &lt;ROOT&gt; -node &lt;NODE&gt; -prop &lt;PROP&gt; -string "&lt;STRING&gt;"
</p>
</li>
<li>
<p>
dt prop -root &lt;ROOT&gt; -node &lt;NODE&gt; -prop &lt;PROP&gt; -int &lt;int&gt;
</p>
</li>
</ul></div>
<div class="paragraph"><p>Note: These script commands allow selective board specific modification of the
Device Tree as BOLT SSBL starts up, independent of the <em>dt bolt</em> command.</p></div>
<div class="paragraph"><p>See also: dt autogen</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;ROOT&gt; and &lt;NODE&gt; are the textual names in the Device Tree.
</p>
<div class="ulist"><ul>
<li>
<p>
<em>cull</em> removes a single Device Tree property within the specified node
if the optional <em>-prop</em> parameter is present, else it deletes the whole node.
</p>
</li>
<li>
<p>
<em>prop</em> adds or modifies a Device Tree property. Currently, only the string
type is supported.
</p>
</li>
<li>
<p>
<em>mac</em> sets the "local-mac-address" property <em>after</em> all physical ENET
(GENET) devices have been allocated a MAC address. The MAC base address
is generally set by the BOLT <em>setsn</em> command and for each device it is
incremented to provide a value unique to the platform it is running on.
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">It is recommended to specify the full node and path when using
these commands as a partial node will match the first that is found.</td>
</tr></table>
</div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>dt cull -root / -node nexus

dt mac -root / -node stb0

dt prop -root /rdb -node sata@f045a000 -prop status -string "disabled"
dt cull -root /rdb -node sata@f045a000 -prop status</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_rtsdefault">5.26.  rtsdefault</h3>
<div class="paragraph"><p>Usage: rtsdefault -id &lt;BOX MODE&gt;</p></div>
<div class="paragraph"><p>Note: Sets the default rts <em>box mode</em> for a chip or board</p></div>
<div class="paragraph"><p>See also: rtsbase rtsconfig</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>rtsdefault -id 2</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
&lt;BOX MODE&gt; should be one of the values of <em>-id</em> specified by a
previous <em>rtsconfig</em> line. If no number matches then the rts
is not set.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_avs">5.27.  avs</h3>
<div class="paragraph"><p>Usage: avs [enable | disable] -domains &lt;VOLTAGE DOMAINS&gt; -mode &lt;avs|dfs|dvfs&gt; -pmap &lt;MAP&gt; -pstate &lt;STATE&gt;</p></div>
<div class="paragraph"><p>Note: Sets the default AVS state and number of voltage domains. Also sets
the DVFS mode, pmap and pstate.</p></div>
<div class="paragraph"><p>See also: n/a</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;VOLTAGE DOMAINS&gt; mentions the number of voltage domains(cpu and settop) on
the platforms that can be build with multiple domains. Default is 2.
</p>
</li>
<li>
<p>
&lt;MAP&gt; mentions all the pstates available for a power profile.
</p>
</li>
<li>
<p>
&lt;STATE&gt; operational state determined by CPU&#8217;s frequency and voltage.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>avs enable -domains 2 -mode dvfs -pmap 0 -pstate 0</code></pre>
</div></div>
<div class="paragraph"><p>AVS will be enabled (started) by default if a corresponding board is
configured as "avs enable". By default, AVS is disabled. To explicitly
disable AVS by default, "avs disable" should be specified. Whether AVS
is enabled or disabled can be overridden anytime by the "setboard"
command on the BOLT command line prompt. The "avs" command can exist
in [family], [chip] and [board].</p></div>
<div class="paragraph"><p>Note: Sets the mode, pmap and p-state. The parameters for the <em>-pmap</em> option
and <em>-pstate</em> are integers.</p></div>
</div>
<div class="sect2">
<h3 id="_sdio">5.28.  sdio</h3>
<div class="paragraph"><p>Usage: sdio -controller &lt;N&gt; -type &lt;T&gt; [-uhs] [-host_driver_strength &lt;S&gt;] [-host_hs_driver_strength &lt;S&gt;] [-card_driver_strength &lt;S&gt;]</p></div>
<div class="paragraph"><p>Note: Sets the default SIO hardware operating mode</p></div>
<div class="paragraph"><p>See also: dt autogen -node sdio</p></div>
<div class="paragraph"><p>Example:</p></div>
<div class="listingblock">
<div class="content">
<pre><code> sdio -controller 0 -type sd -uhs 0
 sdio -controller 1 -type nodevice</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code> sdio -controller 0 -type emmc
 sdio -controller 1 -type sd -uhs 1 -host_driver_strength D</code></pre>
</div></div>
<div class="paragraph"><p>Sets the sdio hardware operating mode. eMMC is enabled by default
for most chips. It is configured depending upon the board and we
recommend that sdio #0 is used as the boot device (for historical
reasons.)</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;N&gt; Which sdio controller to configure for.
</p>
</li>
<li>
<p>
&lt;T&gt; The operating mode (type) which is <em>sd</em>, <em>nodevice</em>, <em>emmc</em> or <em>emmc_on_sdpins</em>
</p>
</li>
<li>
<p>
-uhs (optional) Sets properties in the sdhci Device Tree node for Linux
that will enable Ultra High Speed modes. 1 will add properties to enable
DDR50 and SDR50 modes for SD and HS200 for eMMC. 0 will disable UHS modes
by adding the property "no-1-8-v".
</p>
</li>
<li>
<p>
-host_driver_strength (optional) Set the host controller driver strength property to &lt;S&gt; for Ultra High Speed modes
</p>
</li>
<li>
<p>
-host_hs_driver_strength (optional) Set the host controller driver strength property to &lt;S&gt; for High Speed mode
</p>
</li>
<li>
<p>
-card_driver_strength (optional) Set the SD Card&#8217;s driver strength property to &lt;S&gt;
</p>
</li>
<li>
<p>
&lt;S&gt; Must be "A" (x1.5), "B" (x1.0), "C" (x0.75) or "D" (x0.5)
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_vreg">5.29.  vreg</h3>
<div class="paragraph"><p>Usage: vreg -name &lt;string&gt; -gpio &lt;gpio&gt; -pin &lt;int&gt; -active hi|lo \
                [-udelay &lt;int&gt;]  [-uvolts &lt;int&gt;] [-on_at_boot &lt;int&gt;]</p></div>
<div class="paragraph"><p>This per-board command was created to support the pcie/sata turning
off/on power supplies to its devices during boot, suspend, and
resume.  If you use this command, you will reference the name
of the voltage regulator with -vreg when using the per-board
pcie or sata command.</p></div>
<div class="ulist"><ul>
<li>
<p>
-name &lt;string&gt;&#8201;&#8212;&#8201;name of the regulator
</p>
</li>
<li>
<p>
-gpio &lt;gpio&gt;&#8201;&#8212;&#8201;type of gpio, either <em>upg_gio</em> or <em>upg_gio_aon</em>
</p>
</li>
<li>
<p>
-pin &lt;int&gt;&#8201;&#8212;&#8201;pin number of gpio
</p>
</li>
<li>
<p>
-active &lt;hi|lo&gt;&#8201;&#8212;&#8201;which level enables the gpio
</p>
</li>
<li>
<p>
-udelay &lt;int&gt;&#8201;&#8212;&#8201;(opt) delay in usec between gpio being enabled and
   the enable call returning. Do NOT use this option if you are using
   3.14 Linux images, as the PCI host driver is not compatible
   and you will get serious runtime errors.
</p>
</li>
<li>
<p>
-uvolts &lt;int&gt;&#8201;&#8212;&#8201;(opt) voltage amount, doesn&#8217;t affect anything.
</p>
</li>
<li>
<p>
-on_at_boot &lt;int&gt;&#8201;&#8212;&#8201;(opt) indicates whether the regulator should come
   on at boot.  Off by default.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Examples:</p></div>
<div class="paragraph"><p>vreg -name wifi -gpio upg_gio -pin 14 -active lo</p></div>
</div>
<div class="sect2">
<h3 id="_pcie">5.30.  pcie</h3>
<div class="paragraph"><p>Usage: pcie -controller &lt;N&gt; -type &lt;T&gt; [-ssc 1] [-gen &lt;G&gt;] [-pwr &lt;V&gt;]</p></div>
<div class="paragraph"><p>Note: Sets the default PCIe hardware operating mode on a per board basis.</p></div>
<div class="paragraph"><p>See also: dt autogen -node pcie</p></div>
<div class="paragraph"><p>Examples:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>/* remove pcie #1 */
 pcie -controller 1 -type nodevice</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>/* turn on ssc */
 pcie -controller 0 -type nominal -ssc 1</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>/* turn on ssc, set gen=1 */
 pcie -controller 0 -type nominal -ssc 1 -gen 1</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>/* generate local-mac-address on node pci@0,1 */
 pcie -controller 0 -type nominal -bus 0 -slot 1 -mac 1</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>/* turn off/on/on a power supply on suspend/resume/boot */
 pcie -controller 0 -type nominal -pwr wifi</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>/* turn off/on/on two power supplies on suspend/resume/boot */
 pcie -controller 0 -type nominal -pwr wifi,e1000e</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
&lt;N&gt; is the pcie controller number, typically 0 or 1.
</p>
</li>
<li>
<p>
&lt;T&gt; is thee type; either <em>nodevice</em> for deletion or <em>nominal</em>.
</p>
</li>
<li>
<p>
&lt;G&gt; is the PCIe generation; either 1, 2, or 3.
</p>
</li>
<li>
<p>
&lt;V&gt; is the name of a voltage regulator, previously declared with
      the <em>vreg</em> command.  If it is desired to toggle more than
      one regulator, &lt;V&gt; can be a comma-separated list of
      voltage regulator names.
</p>
</li>
<li>
<p>
<em>-ssc 1</em> is the spread spectrum enable. It defaults to off if
not specified.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Note that the command <em>dt autogen -node pcie</em> generates the
PCIe device information based on the chip family, and the <em>pcie</em>
command described here modifies or deletes individual PCIe devices on
a per board basis.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">Enabling ssc for a PCIe controller that is configured
instead as a SATA device is not recommended as it may cause a
Linux boot failure.</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_sata_2">5.31.  sata</h3>
<div class="paragraph"><p>Usage: sata -controller &lt;N&gt; [-pwr &lt;V&gt;]</p></div>
<div class="paragraph"><p>Note: Sets the default SATA hardware operating mode on a per board basis.</p></div>
<div class="paragraph"><p>See also: dt autogen -node sata</p></div>
<div class="paragraph"><p>Examples:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>/* turn off/on/on a power supply on suspend/resume/boot */
 sata -controller 0 -type nominal -pwr hdd</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
&lt;N&gt; is the pcie controller number, typically 0 or 1.
</p>
</li>
<li>
<p>
&lt;V&gt; is the name of a voltage regulator, previously declared with
      the <em>vreg</em> command.  If it is desired to toggle more than
      one regulator, &lt;V&gt; can be a comma-separated list of
      voltage regulator names.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Note that the command <em>dt autogen -node sata</em> generates the
SATA device information based on the chip family, and the <em>sata</em>
command described here modifies or deletes individual SATA devices on
a per board basis.</p></div>
</div>
<div class="sect2">
<h3 id="_usb">5.32.  usb</h3>
<div class="paragraph"><p>Usage: usb -controller &lt;N&gt; -type &lt;T&gt; [-ipp 0|1|2] [-ioc 0|1] [-bdc on|off|dual|typec_pd]</p></div>
<div class="paragraph"><p>Note: Sets the default USB hardware operating mode on a per board basis.</p></div>
<div class="paragraph"><p>See also: dt autogen -node usb</p></div>
<div class="paragraph"><p>Examples:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>/* remove usb #1 */
 usb -controller 1 -type nodevice</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>/* set ipp to 0 */
 usb -controller 0 -type nominal -ipp 0</code></pre>
</div></div>
<div class="listingblock">
<div class="content">
<pre><code>/* enable BDC driver for device mode only */
 usb -controller 0 -type nominal -bdc on</code></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
&lt;N&gt; is the USB controller number, typically 0 or 1.
</p>
</li>
<li>
<p>
&lt;T&gt; is thee type; either <em>nodevice</em> for deletion or <em>nominal</em>.
</p>
</li>
</ul></div>
<div class="paragraph"><p>This sets the default USB hardware operating mode on a per board
basis. The command <em>dt autogen -node usb</em> generates the
USB device information based on the chip family, and the <em>usb</em>
command described here modifies or deletes individual USB devices on
a per board basis.</p></div>
</div>
<div class="sect2">
<h3 id="_gpio_key">5.33.  gpio_key</h3>
<div class="paragraph"><p>Usage: gpio_key -name &lt;NAME&gt; -gpio &lt;NAME_OF_GPIO_CONTROLLER&gt; -pin &lt;GPIO_PIN&gt; -code &lt;KEY_CODE&gt;</p></div>
<div class="paragraph"><p>Note: Creates device node for the gpio button. You can create multiple gpio buttons.</p></div>
<div class="paragraph"><p>If Nexus is build with NEXUS_HAS_GPIO=1, the Nexus will take ownership of all GPIO pins.
When GPIO block is shared between Nexus and Linux, the interrupt driven operations could
introduce race condition during read-modify-write register access.</p></div>
<div class="paragraph"><p>It&#8217;s important to check that Nexus does not try to reconfigure the pins specified by
&lt;NAME_OF_GPIO_CONTROLLER&gt; and &lt;GPIO_PIN&gt; for any other purposes. The Linux driver which uses
the generated device node should only poll/read the GPIO pins, such that it will not
interfere with Nexus operations on other pins in the same GPIO block.</p></div>
<div class="paragraph"><p>Check the hardware schematics to ensure the correct &lt;NAME_OF_GPIO_CONTROLLER&gt; and &lt;GPIO_PIN&gt;
are used for a given platform.</p></div>
<div class="paragraph"><p>See also: dt autogen gpio</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;NAME&gt; is not used in kernel driver, it&#8217;s better to give a descriptive name based on the usage of gpio pin.
</p>
</li>
<li>
<p>
&lt;NAME_OF_GPIO_CONTROLLER&gt; specifies the gpio controller that is connected to the button, i.e. <em>upg_gio</em> or <em>upg_gio_aon</em>.
</p>
</li>
<li>
<p>
&lt;GPIO_PIN&gt; specified the pin number of the gpio on the gpio controller used for the button.
</p>
</li>
<li>
<p>
&lt;KEY_CODE&gt; specified the key code generated when the button is pressed.
</p>
</li>
</ul></div>
<div class="paragraph"><p>KEY_CODE is determined based on the kernel uapi input header file
<em>linux/include/uapi/linux/input.h</em> It should match the purpose of
the gpio button.</p></div>
<div class="paragraph"><p>Examples:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  gpio_key -name button_A -gpio upg_gio -pin 93 -code 218
  gpio_key -name button_B -gpio upg_gio -pin 90 -code 529</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_gpio_led">5.34.  gpio_led</h3>
<div class="paragraph"><p>Usage: gpio_led -name &lt;NAME&gt; -gpio &lt;NAME_OF_GPIO_CONTROLLER&gt; -pin &lt;GPIO_PIN&gt; -pol &lt;POLARITY&gt;</p></div>
<div class="paragraph"><p>Note: Creates device node for the gpio led driver. You can create multiple gpio leds.</p></div>
<div class="paragraph"><p>See also: dt autogen gpio</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;NAME&gt; is not used in kernel driver, it&#8217;s better to give a descriptive name based on the usage of gpio pin.
</p>
</li>
<li>
<p>
&lt;NAME_OF_GPIO_CONTROLLER&gt; specifies the gpio controller that is connected to the button, i.e. <em>upg_gio</em> or <em>upg_gio_aon</em>.
</p>
</li>
<li>
<p>
&lt;GPIO_PIN&gt; specified the pin number of the gpio on the gpio controller used for the button.
</p>
</li>
<li>
<p>
&lt;POL&gt; specifies the default polarity of the gpio pin (1 = HIGH and 0 = LOW).
</p>
</li>
</ul></div>
<div class="paragraph"><p>Examples:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>  gpio_led -name led_A -gpio upg_gio_aon -pin 20 -pol 0
  gpio_led -name led_B -gpio upg_gio -pin 36 -pol 0</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_bt_rfkill_gpio">5.35.  bt_rfkill_gpio</h3>
<div class="paragraph"><p>Usage: bt_rfkill_gpio -name &lt;NAME&gt; -gpio &lt;NAME_OF_GPIO_CONTROLLER&gt; -pin &lt;GPIO_PIN&gt; -pol &lt;POLARITY&gt;</p></div>
<div class="paragraph"><p>Note: Creates device node for the Bluetooth rfkill gpio. You can have up to 2 GPIOs, one for vreg and another for reset.</p></div>
<div class="paragraph"><p>Check the hardware schematics to ensure the correct &lt;NAME_OF_GPIO_CONTROLLER&gt; and &lt;GPIO_PIN&gt;
are used for a given platform.</p></div>
<div class="paragraph"><p>See also: dt autogen gpio</p></div>
<div class="ulist"><ul>
<li>
<p>
&lt;NAME&gt; used by the kernel driver to get the GPIO pin. Must be either "brcm,vreg-gpio" or "brcm,n-reset-gpio".
</p>
</li>
<li>
<p>
&lt;NAME_OF_GPIO_CONTROLLER&gt; specifies the gpio controller that is connected to the Bluetooth chip, i.e. <em>upg_gio</em> or <em>upg_gio_aon</em>.
</p>
</li>
<li>
<p>
&lt;GPIO_PIN&gt; specifies the pin number of the gpio on the gpio controller used for the Bluetooth chip.
</p>
</li>
<li>
<p>
&lt;POL&gt; specifies the default polarity of the gpio pin (1 = HIGH and 0 = LOW).
</p>
</li>
<li>
<p>
&lt;PDELAY&gt; specifies the delay (in milliseconds) that needs to be introduced post the change of GPIO state.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Examples:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>bt_rfkill_gpio -name brcm,vreg-gpio -gpio upg_gio_aon -pin 5 -pol 0 -pdelay 10
bt_rfkill_gpio -name brcm,n-reset-gpio -gpio upg_gio_aon -pin 6 -pol 1 -pdelay 5</code></pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_copyright_info">6. Appendix: Copyright Info</h2>
<div class="sectionbody">
<div class="paragraph"><p>Copyright &#169; 2017, Broadcom Ltd.
All Rights Reserved.
Confidential Property of Broadcom Ltd.</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Version 1.37<br />
Last updated
 2017-11-09 18:06:33 PST
</div>
</div>
</body>
</html>
